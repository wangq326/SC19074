<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19074" />

<meta name="date" content="2019-12-30" />

<title>homework</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">19074</h4>
<h4 class="date">2019-12-30</h4>



<div id="hw-2019-09-23" class="section level1">
<h1>HW 2019-09-23</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(texts,figures,tables).</p>
</div>
<div id="answer-1-text" class="section level2">
<h2>Answer 1: Text</h2>
<div id="introduction" class="section level3">
<h3>1.1 Introduction</h3>
<p>Here we will introduce a clustering algorithm which is called <span class="math inline">\(K-Means\)</span>. Suppose that there is a dataset which may comes from different populations, we’ll find a way to divide them into k clusters, the greater the similarity within the group, the greater the difference between groups, the better the clustering effect.</p>
</div>
<div id="algorithm" class="section level3">
<h3>1.2 Algorithm</h3>
<p>Suppose that the dataset is <span class="math inline">\(\left\{x^{(1)}, \ldots, x^{(m)}\right\}\)</span>, for each <span class="math inline">\(x^{(i)} \in \mathbb{R}^{n}\)</span>, and we want to assign them to K clusters.</p>
<p>The specific algorithm is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Select K cluster centriods randomly, <span class="math inline">\(\mu_{1}, \mu_{2}, \ldots, \mu_{k} \in \mathbb{R}^{n}\)</span>;</p></li>
<li><p>Repeat the following process until converged:</p></li>
</ol>
<ul>
<li><p>For each sample i, calculate the cluster to which it should belong, <span class="math inline">\(c^{(i)} :=\arg \min _{j}\left\|x^{(i)}-\mu_{j}\right\|^{2}\)</span>;</p></li>
<li><p>For each cluster j, recalculate the centriod of that cluster, <span class="math inline">\(\mu_{j} :=\frac{\sum_{i=1}^{m} 1\left\{c^{(i)}=j\right\} x^{(i)}}{\sum_{i=1}^{m} 1\left\{c^{(i)}=j\right\}}\)</span>.</p></li>
</ul>
</div>
</div>
<div id="answer-2-figure" class="section level2">
<h2>Answer 2: Figure</h2>
<div id="generate-a-dataset-and-visualize" class="section level3">
<h3>2.1 Generate a Dataset and visualize</h3>
<p>In this section, we will create a dataset and visualize the data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Create two groups of points from two different populations</span></a>
<a class="sourceLine" id="cb1-2" title="2">datatest &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">sd =</span> <span class="fl">0.3</span>), <span class="dt">ncol =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1-3" title="3">           <span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="fl">0.3</span>), <span class="dt">ncol =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">colnames</span>(datatest) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># Visualize the data</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">plot</span>(datatest)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cluster-and-visualize" class="section level3">
<h3>2.2 Cluster and visualize</h3>
<p>Next, we divide the dataset into two clusters with kmeans function. After clustering, visualize the clusters winch helps present the clustering effects more intuitively.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Use K-means clustering to divide the whole group into two clusters</span></a>
<a class="sourceLine" id="cb2-2" title="2">kmeanscluster &lt;-<span class="st"> </span><span class="kw">kmeans</span>(datatest, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># Visualize the clusters</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">plot</span>(datatest, <span class="dt">col =</span> kmeanscluster<span class="op">$</span>cluster)</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">points</span>(kmeanscluster<span class="op">$</span>centers, <span class="dt">col =</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">pch =</span> <span class="dv">8</span>, <span class="dt">cex =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="answer-3-table" class="section level2">
<h2>Answer 3: Table</h2>
<p>Finally, we’ll have a look at a dataset called state.x77 which is related to the 50 states of the United States of America. We may be interested in the relevance of these data, and we get their correlation coefficient matrix with the cor function and present the results in a table.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">y &lt;-<span class="st"> </span><span class="kw">cor</span>(state.x77)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">kable</span>(<span class="kw">head</span>(y), <span class="dt">format =</span> <span class="st">&quot;html&quot;</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Population
</th>
<th style="text-align:right;">
Income
</th>
<th style="text-align:right;">
Illiteracy
</th>
<th style="text-align:right;">
Life Exp
</th>
<th style="text-align:right;">
Murder
</th>
<th style="text-align:right;">
HS Grad
</th>
<th style="text-align:right;">
Frost
</th>
<th style="text-align:right;">
Area
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Population
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.2082276
</td>
<td style="text-align:right;">
0.1076224
</td>
<td style="text-align:right;">
-0.0680520
</td>
<td style="text-align:right;">
0.3436428
</td>
<td style="text-align:right;">
-0.0984897
</td>
<td style="text-align:right;">
-0.3321525
</td>
<td style="text-align:right;">
0.0225438
</td>
</tr>
<tr>
<td style="text-align:left;">
Income
</td>
<td style="text-align:right;">
0.2082276
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
-0.4370752
</td>
<td style="text-align:right;">
0.3402553
</td>
<td style="text-align:right;">
-0.2300776
</td>
<td style="text-align:right;">
0.6199323
</td>
<td style="text-align:right;">
0.2262822
</td>
<td style="text-align:right;">
0.3633154
</td>
</tr>
<tr>
<td style="text-align:left;">
Illiteracy
</td>
<td style="text-align:right;">
0.1076224
</td>
<td style="text-align:right;">
-0.4370752
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
-0.5884779
</td>
<td style="text-align:right;">
0.7029752
</td>
<td style="text-align:right;">
-0.6571886
</td>
<td style="text-align:right;">
-0.6719470
</td>
<td style="text-align:right;">
0.0772611
</td>
</tr>
<tr>
<td style="text-align:left;">
Life Exp
</td>
<td style="text-align:right;">
-0.0680520
</td>
<td style="text-align:right;">
0.3402553
</td>
<td style="text-align:right;">
-0.5884779
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
-0.7808458
</td>
<td style="text-align:right;">
0.5822162
</td>
<td style="text-align:right;">
0.2620680
</td>
<td style="text-align:right;">
-0.1073319
</td>
</tr>
<tr>
<td style="text-align:left;">
Murder
</td>
<td style="text-align:right;">
0.3436428
</td>
<td style="text-align:right;">
-0.2300776
</td>
<td style="text-align:right;">
0.7029752
</td>
<td style="text-align:right;">
-0.7808458
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
-0.4879710
</td>
<td style="text-align:right;">
-0.5388834
</td>
<td style="text-align:right;">
0.2283902
</td>
</tr>
<tr>
<td style="text-align:left;">
HS Grad
</td>
<td style="text-align:right;">
-0.0984897
</td>
<td style="text-align:right;">
0.6199323
</td>
<td style="text-align:right;">
-0.6571886
</td>
<td style="text-align:right;">
0.5822162
</td>
<td style="text-align:right;">
-0.4879710
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
0.3667797
</td>
<td style="text-align:right;">
0.3335419
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hw-2019-09-29" class="section level1">
<h1>HW 2019-09-29</h1>
<div id="question-exercise-3.4-from-page-74" class="section level2">
<h2>1 Question : exercise 3.4 From Page 74</h2>
<p>The Rayleigh density [156, Ch.18] is <span class="math display">\[
f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0.
\]</span>Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ&gt;0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
</div>
<div id="answer-the-acceptance-rejection-methood" class="section level2">
<h2>1.1 Answer : the acceptance-rejection methood</h2>
<p>Here we assign <span class="math inline">\(g(x)\)</span> to be the pdf of Gamma(2,<span class="math inline">\(1/\sigma^2\)</span>), and c is <span class="math inline">\(Gamma\left(2\right)\sigma^4e^{1/2\sigma^2}\)</span>.</p>
<p>In this exercise, we choose <span class="math inline">\(\sigma^2\)</span> to be 1, 4, 0.25, 16.</p>
<div id="sampling-function-via-the-acceptance-rejection-methood" class="section level3">
<h3>1.1.1 Sampling function via the acceptance-rejection methood</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># generate n r.v. from f(x) with sigma2</span></a>
<a class="sourceLine" id="cb4-2" title="2">rRayleigh &lt;-<span class="st"> </span><span class="cf">function</span>(n, sigma2){</a>
<a class="sourceLine" id="cb4-3" title="3">  j&lt;-k&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb4-4" title="4">  y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {</a>
<a class="sourceLine" id="cb4-6" title="6">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-7" title="7">  j &lt;-<span class="st"> </span>j <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1</span>,<span class="dt">shape =</span> <span class="dv">2</span>,<span class="dt">scale =</span> sigma2) <span class="co"># random variate from g</span></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="cf">if</span> (<span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2-2</span><span class="op">*</span>x<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma2)) <span class="op">&gt;</span><span class="st"> </span>u) {</a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="co">#we accept x</span></a>
<a class="sourceLine" id="cb4-11" title="11">    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-12" title="12">    y[k] &lt;-<span class="st"> </span>x</a>
<a class="sourceLine" id="cb4-13" title="13">    }</a>
<a class="sourceLine" id="cb4-14" title="14">  }</a>
<a class="sourceLine" id="cb4-15" title="15">  <span class="kw">hist</span>(y, <span class="dt">prob =</span> <span class="ot">TRUE</span>)  </a>
<a class="sourceLine" id="cb4-16" title="16">  y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">.002</span>)</a>
<a class="sourceLine" id="cb4-17" title="17">  <span class="kw">lines</span>(y, y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma2))<span class="op">/</span>sigma2) </a>
<a class="sourceLine" id="cb4-18" title="18">}</a></code></pre></div>
</div>
<div id="sigma21" class="section level3">
<h3>1.1.2 <span class="math inline">\(\sigma^2=1\)</span></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">rRayleigh</span>(<span class="dv">100000</span>,<span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma24" class="section level3">
<h3>1.1.3 <span class="math inline">\(\sigma^2=4\)</span></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">rRayleigh</span>(<span class="dv">100000</span>,<span class="dv">4</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma20.25" class="section level3">
<h3>1.1.4 <span class="math inline">\(\sigma^2=0.25\)</span></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">rRayleigh</span>(<span class="dv">100000</span>,<span class="fl">0.25</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma216" class="section level3">
<h3>1.1.5 <span class="math inline">\(\sigma^2=16\)</span></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">rRayleigh</span>(<span class="dv">100000</span>,<span class="dv">16</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="analysis-of-the-result-of-exercise-3.4" class="section level2">
<h2>1.2 Analysis of the result of exercise 3.4</h2>
<p>From the histogram, it is easy to find that the simulated sampling obtained by the acceptance-rejection method is very close to the real Rayleigh distribution sampling result, which can indicate that we have obtained the result with good performance. Further, we can also check that the mode σ of the generated samples is close to the theoretical mode σ.</p>
</div>
<div id="question-exercise-3.11-from-page-75" class="section level2">
<h2>2 Question : exercise 3.11 from page 75</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0,1)and N(3,1)distributions with mixing probabilities p1 and p2 =1−p1. Graph the histogram of the sample with density superimposed, for p1 =0.75. Repeat with diﬀerent values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
</div>
<div id="answer-transformation-methods" class="section level2">
<h2>2.1 Answer : Transformation methods</h2>
<div id="sampling-function-via-transformation-methods" class="section level3">
<h3>2.1.1 Sampling function via transformation methods</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">normlocationmixture &lt;-<span class="st"> </span><span class="cf">function</span>(n, p){</a>
<a class="sourceLine" id="cb9-2" title="2">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-4" title="4">  r &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, p)</a>
<a class="sourceLine" id="cb9-5" title="5">  z &lt;-<span class="st"> </span>r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="kw">hist</span>(z, <span class="dt">probability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-7" title="7">  z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">10</span>, <span class="fl">.001</span>)</a>
<a class="sourceLine" id="cb9-8" title="8">  <span class="kw">lines</span>(z,p<span class="op">*</span><span class="kw">dnorm</span>(z,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span><span class="kw">dnorm</span>(z,<span class="dv">3</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb9-9" title="9">}</a></code></pre></div>
</div>
<div id="p10.75" class="section level3">
<h3>2.1.2 p1=0.75</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">normlocationmixture</span>(<span class="dv">10000</span>, <span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///8ufgoAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJvUlEQVR4nO2deWObNhyGlS5ZsnRHsnRr3Z11t2Wjx0IS8/0/2hACcxjxIiTxk733+aMxGB08FbrAQhVkEiWdgdShIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCANEF7Tbq4sH8vdxvdL7+45/QCb6/UurbYNEJC3q6exFaUK5KboJFt66gA7YquKBMnb0LGJ1ICfpwrdTZN/faT4lW9OmVUl/8UBWu3Xulzt9V5spz/fVOvbgvPt2Vx70sz/v5Vl1+ulZnr4sPV+VRbTL7CKoojaLyYNVuLURCUGbyXRpoBNV79IHlIfqcrtvdFw/5/kSbc1bXjVpDG8ExCmqoBelS8FB8rCoKc4k9XtXebqoq5PJht228XdwX/5ahvnzQB91U53yjw6rX9fEV3QgGl9hWDdsFNwQElWdz/lf9rRFU10RbU6j051KEEfSmPvDzn9c6gnJ/ebrm38pYN5qiuS47gjLPAiQhyOwxNU51Ss1VqE+t+dw7191PTQS69BX1v62gbgR9QeUxe8fLkKiDnu5M1fB77cGcb3V1vWk+dwVpo+e/fL61CupG0BOkQ460nS7I9IOefr5uqtQZJciYeLYLspagrfLuRoh1FHdv2xrHXgdV51oVjH0lPSLIVgflvhVQISKozPZ31XVWNTz6DOytWFOCLh6eNvY6yNKKmSbPE4kS9L7tnuSgH7SvgyYr6W4/qCMob1uH5YhcYh91DfTyvqi7zfd1R/hHE6Dc9fX9QSt2/ltW7rIJ6kRwbIIWsvXr3oUjOUHbaq6iLB2ezXMokhPUXBdBh+QeJCeoeHp1VY/1kyA9QYlBQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAqQnSI18EiSJTHRRFDRNJ0MqhcylkIceyvJZihTy0KUuNaqHaIYkEx9Bdf80tqQyI574CGrkDwV1oKBpFAVNo/p/jS8KalFjf09AUIgWebRlPxVBIaLruaCg8aDqQJDyi9SfxAQdxENBvaAUBIJS0HRQRUHTQUfmypSioDbo2GQiBXWCUhAISkHTQUfn68udFFQH7c7XW/avDwUBKAhAQYAjEHRSt338JszG46GgOmhPiu2L1dkn3ixztSyWIFOuY9kafrE6ncT1Gjy+6xGdtKAigKMYgtJqxTLltS7aiQvSS9O8KXab5Wsbec4ozthYmzZxvSSaMZMvL0InLOj5Fi5p9Hyr66d86iKMI0jSUCvoe+NnovhUgjJdyp5vLet//g8EZdOCajWZpZpafioqbUHbtqtnb+a1oMerSpCtnJ2soLYETSBXggQNuSRtVvi+LJrq2jO6QcipVuxIBBWVo7Kxy63X4akKKkvEfrV4r/WFT1WQfHSKglDASUFyhrpDjZvqNQRea8xGEiRYhNqUt/p9BZfF1j5ttq+m7DXVCQvSHZy8HMtPjVR3G1SDn7igrV7kesrBbgOmZZeeyPAG88GGmKHOJXb5fKtfmzKpIB9/S4X3nPSwkKQoqOoDwiIyOzrncMkLEo0OC5IydCyCxIpQm27zcoZZQw1bVb7wNA6eRExR0DbEu+KWChoGHU53yP0+s9PMh3gvYBxB3V2CgvxeMzWIzj1Y6oJmNfCwnoopSB1+swJtepY+YJesmSizzpgty/7hb3rGNoQFzZgw223alw0FnZM+bKYSFDSDTjUV9q7GTEEizb1LesIlSKY/1Emvevfkdqqxz5pqKnQddBB0XJDEoKxTSZ+9y/RofspQU1FZpx0XZX/k2hnfEBWkrx994UzOB82Pzj3QHEECU2e9jqIW5PHsSxFbkMQPNw5K0Hb9F//OF1So1Qdmwzoo83uxrVuO7SdrFTRcX2hpRufnsf1Y1cDLXgy38L/UPsiCQ/t2wy2nzgSOfwVBg43Yho5eUGxDg7GY77s7BQRFNtREvjWVc+b5rP0CQcpXUNyWv448byrn+hE7z+hcju6NtEbjgYJiGjJxd2bLJu7Nz47O6WgvQfE7RSbWzghszaFGoBIUdZzfCIIzPS7RuRx9sGTQko2I43x5QaNBXTfiDWNPRFBxsoJGVsRZtBFtnN8Igs+OuUTncHSvDFjimbURV5BQdEEFRW3mhaILKShWd1FYkG2Bdgqqj+5VIrZ4ZnernRKfCQUBZAXZVqNYOjBzSn0eYeJcOuXaq0MK7410BS2MLrigCIZOSlCMIiTdDwq7EaEISQqadyvMaSO8IbcIwz6CF0FQ+IvMKcKwj+DNvJnqKCi0IZf4Aj9AhX7g47wRZYLaJaKwj+DBX0At3FCuGZlGrgQNW+VggsLWRY51ULhH8Gb8PGPhRtgZfLeIAj6Cd3AW4TaCzuBL9YPmPTu+cCPkBPXagtyfmVqyIdSKhego1m3MSFMTdENIUICOYq83F09QuDK0djOvunmPKShUIVq7o9ireeKWoDDd6nVL0CCzUUtQJ721BNk7ioP/K3UERBGEO4qnR+B+0OlBQYCFgvwe1DsmVihBspVxhU/ug3lYkIT8NxgKAgQerLolIf8NJvBg1S0J+W8wgYcabknIf4MJPFh1S0L+GwxLECDMYHVhEvLfYFYYrMprSLwfdNxQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwDqC3BZGy20LYVVT4taJFksij1fK4xW76wjKneZH9Eo0+Zih3abcm9nO1pJIXu4Fr3qYZA1B1RKfs48285Zji9CYpXssN3UtiZjYPG4EryEou3jrIGhSQ1GMFy5rIo9fLVq1rmUFQWUeXeogc0r2uwLja+/bEslf/H3r9Xrm+IJ0IXcRZEqIpZzYpsOtiWT6JqfP61TiC3Jd3nNaUD5eR1sTyc6myyMkuqDqigl2iVlup9gTMXWZx8psMQVVL2fP6idQZudwqpK2LdJnT8SI9qiq0+so2pv5Ynqh2dFEzN3glC+xCqeetLWj+Hg12RqNJ6Jrp84tYWcSFKQvmNEqur6QbO2bJZF8aniC4WAVQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQESF2QeeTF7+WvXqQuSCO6HtgRCPJ8N64n6QvabURXbUxfUGZ75G4dkhcEntyMTuqChC+w9AUJX2DJC2qW3ZNrxxIXJA8FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4DxMdKwW4Aku4AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="try-different-values-of-p1" class="section level3">
<h3>2.1.3 Try different values of p1</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">p &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.05</span>,<span class="dv">1</span>,.<span class="dv">05</span>)</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)){</a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="kw">normlocationmixture</span>(<span class="dv">10000</span>,p[i])</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="kw">print</span>(p[i])</a>
<a class="sourceLine" id="cb11-5" title="5">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.05</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.1</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.15</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.2</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.25</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.3</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.35</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.4</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.45</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.5</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.55</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.6</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.65</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb////tmb/25D/27b//7b//9v///8ufgoAAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ/0lEQVR4nO2dDXfjJhaGyexkk6bdbdKZtkn3ox3PbrPVfDROYv3/n7ZCSDZyBC8IMNfO+5wzyTgRCD0HLggRpFriRdUugHQoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgQHFBmzt1/mC+X2w/WL/+zx+5T/jxUqm/Z8uusqCnd29yC1qrjuts2R1W0AtWKrugRp19yJhdlRr06Uqps7/daz8dWtGX90r95ce+cm0+KvX2Q2+uu9Z/v1Nv7tsv77rjvu2u+/lGXXy5Umc/t58uu6N2p9lm0GdpFHUHq92nhdQQ1JhydwZGQcNP9IHdIfqarnY/Pn9Yby90vGZ1Nao17DI4RkEjgyBdCx7az32gME3s8XLwdt2HkIuHzWr0dn7f/tml+uuDPui6v+ZrnVb9PBzfY2ew18RWar9fiKOCoO5q3v4+/NYIGiLRylQq/f9OhBF0Oxz49b9XOoPu593lmq+9MTubdmyXlqAmsQLVEGR+YiJOf0ljK9SXNv5/cq2bf4wZ6NrXDl93guwMpoK6Y7aOl1EjBj29M6Hht8GDud6+dd2O/7cFaaNv//X1xinIzmAiSKec6TtjqDMOevrn1RhSA2qQMfHsFuSsQSuVPIyoNlDc/LKLOO4Y1F9rXzG2QXpGkCsGrVMDUFtFUFfs7/t21nc8+grcvdhYg84fnu7cMcjRi5kuL5EaNejjbniyBuOgbQzyBml7HGQJWu96h+VUaWKfdQT69r4dhs33w0D4J5Og+9F39y96sbe/Nt2PXIKsDI5N0EJWacO7fIgTtOrnKrrakdg950KcoLFdZL0lT0CcoPbp/eVwry8CeYKEQUEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAMIE9StfahdigrDSqPGLGOQUZlxQKMyQnLIMZlQrqVCSyjLK2dUkEUgphy6J2tYeJadgUsrRCzLf2r6tSSmYlHL0bav/Zj6IKZiUcmz7ruErY9ALJoLkdPVSynHiglSGzllNv52WoBzZTQWJqdpiBKl9QUIMURCAggBSBCkKQglfCJJhSK4gIf0YBQGECFJzgkQYkiLo5UBRyLyZXEFCZl9FC5IwsShDkJoVJGLmVYigloJgMgoCyeYECRgMbQswbnOVKbuIJNMOfTIfJEmQ2YMndT+iJYK2MiY5CBTULneUMuXqFSRvoNiopH3RMgsScLsxKYDemua23dwt39tokSB1HIL0lmjGzHp5FVomyE4qVtDzTY4tjU5Z0A/Gj6f6PN/oAL72RancggT1YqOgBghqdDN8vnFskLpsHGQnFSpoteuo3d28FjSoaRxxfJGgSdJ9QbUNvahBHrSgx8tekKshnrCgAF53DQrAbIF+0Y7hOjG7MckxCOoueLtbvHcQ1B3VjQbWzkC1bCRtf38hqLKh+tMdQFDtfoyCAPatxnX/GoKkPWZLCKpraHf2lX5fwUW7Spo2i78YhQRVrkLWvdhtF3xv/bcau+FktnHQUQla6U2uPb3Y5g7d5+cXVPsBq9XELp5v9GtTfE1scwcaYIkaVLcWTeaD9Fsb/AbW86/xWD7lqo5HUJ3s1JyRvY9Vn/4cg6Cqg6HdmceXMyS9yqSQIBlBOsaMq6+LvRAVJKjmYNHq5nO8FzBaEB5J919FCEp7zdRediHHTjs+6YLgECcuu8BjA2uQiCDtGOJMgIE8UpAKFlTNkNXE8IRZM06UOWfMYgW1xyMogM3d7m1MGeak4wRNcs7x92nhpQzGiuM5nmpECZrWodHNARRZ+ffvnlx5OvvsNUhFCLIN2autShuygvTZh0bfzXsMNWMczxSDlJ0ENbFdk7KGBuUbmtXNX/f1wjcftI3kznnZYoL6L2p27HQgQTrAaEEJa1/awoJ2uwtNDzpsDVod7MW/sxcLBor+jyXYj0FN2ott4wRNkqQIKmho2oslvxiulqByhvLkvGjgllFQwUaWOedqgooZsnoxb/8dm134sXmCdHFBKxOcm8S19vUElTI05Lseg/Owgiwxu6BDswoqZshka82WHezZfE5BBW85TJ7WHZj3ViMwu7BD89agUk/PRkFwIiMmu6Ajcwsq1NnXE5Q3SLelhosnJKhMnK4laG6rBc/H+oLg0qiY7MIOzC6oYAw6fHZlBBUwVEHQ3qglq6D8hmoIsv61eQUVaGSnJii7oTqCVCFBBe44Kgmyjs3bi2XfMaaKIM+fOSd38zIFRU25hv2R6mJBmSN1nRpkH5tZUO6+voagoL/iXSwoc09WRdDk2JMSlGWFWWlBeQ1F5ZVnhVncxS5JU0tQnvVBQctaEwVlNBSTVZYVZmHrftME5axDB69BYUvrEwVlNBQZg5JXmAX+7UGqoHyG4vJJW2EWsbQ+NQblu2nNOmZAgiJWbabWoGyh+qCCIpaUpQvK1MriMkkbKMasd8kgKI+hyCCdMlCMmoTOIyiDooN185Gz9LkEJUuKSb10oLjkMUYWQcPJZ0saygFq0P7q5sMKss6/iMgY5BgoquOjiCA8UDw9Mo+DTg8KAiwUlLZQ75goUoPqhl8XC68lr5qQTCv9loIkCArcAOXVCsI3qyGZnq6ggFuNkExPV1DwWtjXKog1CIGfaoRkesKCQm9WX6+gVwgFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoClBLk3gqtn9d2zJasfVtg+RKikz5eqoXv2S0kaO2cEdncdQqa+dLqPWjWLkO+hOik6+4X/vc9OCkjqN/Uc/5XZv+d2SezZsbStf2MJyE6qcl42dPgMoKa81/8c2qz9QQqcCVEJ338ZvnWdUUEdQUC2zHObqBvrsP/PMC9877npOs3/7tZ+h7rEoJ0jfYLmp/TNrXDU0d8k+G+kzb6SefCLddLCIIbeq7dMdovyJEQnbQ5w1XTRQFBfUvxCXJVA9jEPA9TvCc1YW3Z9mx5BfWvY2+G5SYvijO8rN250x4K0r4t+pwn1Rjny0L14QeK7t1i/d28JyE6qXkkLKaJ9TgFPV66q4F3oOhLiE6qA5T1XDiGgwsa2sK8hsZzq+FNCE7av8FbTjd/UlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAaQLMote0l7+moR0QZqq+4EdgaDEd+MmIl/Q5q7qro3yBTW+RXflES8oYO1mUaQLqtzA5Auq3MDECxq33avXjwkXVB8KAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjwfyng0t7cmSVEAAAAAElFTkSuQmCC" /><!-- --></p>
<pre><code>## [1] 0.7</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.75</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.8</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.85</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.9</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 0.95</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## [1] 1</code></pre>
</div>
</div>
<div id="analysis-of-the-result-of-exercise-3.11" class="section level2">
<h2>2.2 Analysis of the result of exercise 3.11</h2>
<p>By taking different values of p1, we find that in some cases there will be bimodal mixture. Through experiments, an approximate guess can be made that when 0.25&lt;p1&lt;0.75, bimodal mixture will occur.</p>
</div>
<div id="question-exercise-3.18-from-page-76" class="section level2">
<h2>3 Question : exercise 3.18 from page 76</h2>
<p>Write a function to generate a random sample from a Wd(Σ,n) (Wishart) distribution for n&gt;d+1≥1, based on Bartlett’s decomposition.</p>
</div>
<div id="answer-wishart-distribution-based-on-bartletts-decomposition" class="section level2">
<h2>3.1 Answer : Wishart distribution based on Bartlett’s decomposition</h2>
<p>Notice that here we are required to sample from Wishart distribution based on Bartlett’s decomposition. However, it’s easy to find that generating a sample by its definition is much more convenient. So, in this exercise both method will be implemented.</p>
<div id="sampling-function-via-bartletts-decomposition" class="section level3">
<h3>3.1.1 Sampling function via Bartlett’s decomposition</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">Wdsampling1 &lt;-<span class="st"> </span><span class="cf">function</span>(Sigma, d, n){</a>
<a class="sourceLine" id="cb32-2" title="2">  <span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb32-3" title="3">  L &lt;-<span class="st"> </span><span class="kw">chol</span>(Sigma) <span class="co"># Sigma=LL&#39;</span></a>
<a class="sourceLine" id="cb32-4" title="4">  T &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> d, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb32-5" title="5">  <span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>d)){</a>
<a class="sourceLine" id="cb32-6" title="6">    T[i,i] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb32-7" title="7">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i<span class="dv">-1</span>){</a>
<a class="sourceLine" id="cb32-8" title="8">      T[i,j] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-9" title="9">    }</a>
<a class="sourceLine" id="cb32-10" title="10">  } </a>
<a class="sourceLine" id="cb32-11" title="11">  S &lt;-<span class="st"> </span>L<span class="op">%*%</span>T<span class="op">%*%</span><span class="kw">t</span>(T)<span class="op">%*%</span><span class="kw">t</span>(L)  <span class="co">#Bartlett&#39;s decomposition</span></a>
<a class="sourceLine" id="cb32-12" title="12">  S</a>
<a class="sourceLine" id="cb32-13" title="13">}</a></code></pre></div>
</div>
<div id="generate-a-sample" class="section level3">
<h3>3.1.2 Generate a sample</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">Wdsampling1</span>(<span class="kw">diag</span>(<span class="dv">3</span>)<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]
## [1,] 15.724163  5.605361 -4.639041
## [2,]  5.605361  2.844255 -1.968094
## [3,] -4.639041 -1.968094 10.292119</code></pre>
</div>
<div id="sampling-function-via-its-definition" class="section level3">
<h3>3.1.3 Sampling function via its definition</h3>
<p>This method is from <a href="https://www.datalearner.com/blog/1051508471131357" class="uri">https://www.datalearner.com/blog/1051508471131357</a>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">Wdsampling2 &lt;-<span class="st"> </span><span class="cf">function</span>(Sigma, d, n){</a>
<a class="sourceLine" id="cb35-2" title="2">  <span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb35-3" title="3">  Id &lt;-<span class="st"> </span><span class="kw">diag</span>(d)  </a>
<a class="sourceLine" id="cb35-4" title="4">  Md &lt;-<span class="st"> </span><span class="kw">numeric</span>(d)</a>
<a class="sourceLine" id="cb35-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, Md, Id)  <span class="co">#x[i,]~N(0,Id)</span></a>
<a class="sourceLine" id="cb35-6" title="6">  L &lt;-<span class="st"> </span><span class="kw">chol</span>(Sigma)</a>
<a class="sourceLine" id="cb35-7" title="7">  <span class="cf">for</span> (i <span class="cf">in</span> (<span class="dv">1</span><span class="op">:</span>n)){</a>
<a class="sourceLine" id="cb35-8" title="8">      A &lt;-<span class="st"> </span>x[i,]<span class="op">%*%</span><span class="kw">t</span>(x[i,])</a>
<a class="sourceLine" id="cb35-9" title="9">  } <span class="co"># generate a wishart(Id,d,n) sample</span></a>
<a class="sourceLine" id="cb35-10" title="10">  S &lt;-<span class="st"> </span>L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(L)</a>
<a class="sourceLine" id="cb35-11" title="11">  S</a>
<a class="sourceLine" id="cb35-12" title="12">}</a></code></pre></div>
</div>
<div id="generate-a-sample-1" class="section level3">
<h3>3.1.4 Generate a sample</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">Wdsampling2</span>(<span class="kw">diag</span>(<span class="dv">3</span>)<span class="op">+</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)</a></code></pre></div>
<pre><code>##            [,1]      [,2]       [,3]
## [1,] 0.01947682 0.1331315 0.03984076
## [2,] 0.13313154 0.9100051 0.27232686
## [3,] 0.03984076 0.2723269 0.08149616</code></pre>
</div>
</div>
</div>
<div id="hw-2019-10-11" class="section level1">
<h1>HW 2019-10-11</h1>
<div id="question-1-exercise-5.1" class="section level2">
<h2>1 Question 1 : exercise 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math inline">\(\int_0^{\frac{\pi}{3}} sint dt\)</span>.</p>
</div>
<div id="answer" class="section level2">
<h2>1.1 Answer</h2>
<p>According to <span class="math inline">\(\int_0^{\frac{\pi}{3}} sint dt=\frac{\pi}{3}E\left(sint\right),t\sim U\left(0,\frac{\pi}{3}\right)\)</span> , we can calculate it as below.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">m &lt;-<span class="st"> </span><span class="fl">1e4</span>   <span class="co"># number of samplings</span></a>
<a class="sourceLine" id="cb38-2" title="2">t &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)   <span class="co"># generate samples from U(0,pi/3)</span></a>
<a class="sourceLine" id="cb38-3" title="3">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(t)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span>  <span class="co"># calculate theta.hat</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="fl">0.5</span>))  <span class="co"># check it vs the true value</span></a></code></pre></div>
<pre><code>## [1] 0.5041527 0.5000000</code></pre>
</div>
<div id="analysis-of-the-result" class="section level2">
<h2>1.2 Analysis of the result</h2>
<p>It’s easy to find that when the number of samplings is 10000, a Monte Carlo estimate of <span class="math inline">\(\int_0^{\frac{\pi}{3}} sint dt\)</span> is 0.5041527, which is close to the true value of it.</p>
</div>
<div id="question-2-exercise-5.10" class="section level2">
<h2>2 Question 2 : exercise 5.10</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math inline">\(\int_0^1\frac{e^{-x}}{\left(1+x^2\right)} dx\)</span>, and ﬁnd the approximatereduction in varianceas a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-antithetic-variables" class="section level2">
<h2>2.1 Answer : Antithetic variables</h2>
<ul>
<li>step 1 : set the number of sampling <span class="math inline">\(n\)</span></li>
<li>step 2 : generate <span class="math inline">\(\frac n2\)</span> samples from U(0,1), <span class="math inline">\(x_1,x_2,…,x_{\frac n2}\)</span></li>
<li>step 3 : estimate it as <span class="math inline">\(\hat\theta=\frac1n\sum_{j=1}^{n/2}\left(\frac {e^\left(-x_j\right)}{1+x_j^2}+\frac {e^\left(-1+x_j\right)}{1+(1-x_j)^2}\right)\)</span>, <span class="math inline">\(U_j\sim U(0,x)\)</span></li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">n &lt;-<span class="st"> </span><span class="fl">1e4</span>   <span class="co"># number of samplings</span></a>
<a class="sourceLine" id="cb40-2" title="2">x &lt;-<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)   <span class="co"># generate n/2 samples from U(0,1)</span></a>
<a class="sourceLine" id="cb40-3" title="3">y &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>x</a>
<a class="sourceLine" id="cb40-4" title="4">u &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-5" title="5">v &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>y)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>y<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-6" title="6">theta1.hat &lt;-<span class="st"> </span>(<span class="kw">mean</span>(u)<span class="op">+</span><span class="kw">mean</span>(v))<span class="op">/</span><span class="dv">2</span>  </a>
<a class="sourceLine" id="cb40-7" title="7">sd1.hat &lt;-<span class="st"> </span><span class="kw">sd</span>((u<span class="op">+</span>v)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-8" title="8"><span class="co"># estimate it with antithetic variables </span></a>
<a class="sourceLine" id="cb40-9" title="9">x1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-10" title="10">u1 &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x1)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x1<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb40-11" title="11">theta2.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(u1)</a>
<a class="sourceLine" id="cb40-12" title="12">sd2.hat &lt;-<span class="st"> </span><span class="kw">sd</span>(u1)</a>
<a class="sourceLine" id="cb40-13" title="13"><span class="co"># estimate it without variance reduction</span></a>
<a class="sourceLine" id="cb40-14" title="14">re.sd &lt;-<span class="st"> </span>(sd2.hat<span class="op">-</span>sd1.hat)<span class="op">/</span>sd2.hat  <span class="co">#the approximate reduction in varianceas</span></a>
<a class="sourceLine" id="cb40-15" title="15"><span class="kw">print</span>(re.sd)</a></code></pre></div>
<pre><code>## [1] 0.8646674</code></pre>
</div>
<div id="analysis" class="section level2">
<h2>2.2 Analysis</h2>
<p>By using the antithetic variables method, the approximate reduction in variance is 0.8646674 of the variance without variance reduction. At almost the same calculation cost, the variance is reduced.</p>
</div>
<div id="question-3-exercise-5.15" class="section level2">
<h2>3 Question 3 : exercise 5.15</h2>
<p>Obtain the stratiﬁed importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<p>Example 5.13 (Example 5.10, cont.) In Example 5.10,our best result was obtained with importance function <span class="math inline">\(f_3(x)= e^\left(−x\right)/(1−e^\left(−1\right))\)</span>,<span class="math inline">\(0&lt;x&lt;1\)</span>. From 10000 replicates we obtained the estimate <span class="math inline">\(\widehat\theta =0 .5257801\)</span> and an estimated standard error 0.0970314. Now divide the interval (0,1) into ﬁve subintervals,<span class="math inline">\((j/5,(j +1)/5)\)</span>, <span class="math inline">\(j =0 ,1,...,4\)</span>. Then on the <span class="math inline">\(j\)</span>th subinterval variables are generated from the density <span class="math display">\[\frac {5e^\left(-x\right)}{1-e^\left(-1\right)},\frac{j-1}{5}&lt;x&lt;\frac j5.\]</span> The implementation is left as an exercise.</p>
<p>Example 5.10 (Choice of the importance function) In this example (from [64, p. 728]) several possible choices of importance functions to estimate <span class="math inline">\(\int_0^1\frac{e^{-x}}{\left(1+x^2\right)} dx\)</span> by importance sampling method are compared. The candidates for the importance functions are <span class="math display">\[f_0(x)=1,0&lt;x&lt;1,\]</span> <span class="math display">\[f_1(x)=e^\left(-x\right),0&lt;x&lt;\infty,\]</span> <span class="math display">\[f_2(x)=(1+x^2)^\left(-1\right)/\pi,-\infty&lt;x&lt;\infty,\]</span> <span class="math display">\[f_3(x)=\frac {e^\left(-x\right)}{1-e^\left(-1\right)},0&lt;x&lt;1,\]</span> <span class="math display">\[f_4(x)=4(1+x^2)^\left(-1\right)/\pi,0&lt;x&lt;1\]</span></p>
</div>
<div id="preface" class="section level2">
<h2>3.0 Preface</h2>
<p><strong>Notice that 3.1 sections is computed according to the requirement of Example 5.13, and 3.2 section is computed as stated in page 147.</strong> <strong>也即3.1部分按照例13的要求计算，3.2部分按照课本p147的方法计算.</strong></p>
</div>
<div id="answer-1" class="section level2">
<h2>3.1 Answer</h2>
<div id="example-5.10-importance-function" class="section level3">
<h3>3.1.1 Example 5.10 : Importance function</h3>
<ul>
<li>step 1 : set number of samples <span class="math inline">\(m\)</span></li>
<li>step 2 : generate samples <span class="math inline">\(x_1,x_2,…,x_m\)</span> from <span class="math inline">\(f\)</span></li>
<li>step 3 : estimate it as <span class="math inline">\(\hat\theta=\frac1m\sum_{i=1}^m\frac{g(X_i)}{f(X_i)}\)</span></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb42-2" title="2">theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb42-3" title="3"></a>
<a class="sourceLine" id="cb42-4" title="4">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb42-5" title="5">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb42-6" title="6">}</a>
<a class="sourceLine" id="cb42-7" title="7"></a>
<a class="sourceLine" id="cb42-8" title="8">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#using f0</span></a>
<a class="sourceLine" id="cb42-9" title="9">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)</a>
<a class="sourceLine" id="cb42-10" title="10">theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb42-11" title="11">se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb42-12" title="12"></a>
<a class="sourceLine" id="cb42-13" title="13">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(m, <span class="dv">1</span>) <span class="co">#using f1</span></a>
<a class="sourceLine" id="cb42-14" title="14">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)</a>
<a class="sourceLine" id="cb42-15" title="15">theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb42-16" title="16">se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb42-17" title="17"></a>
<a class="sourceLine" id="cb42-18" title="18">x &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(m) <span class="co">#using f2</span></a>
<a class="sourceLine" id="cb42-19" title="19">i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">which</span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), <span class="kw">which</span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb42-20" title="20">x[i] &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co">#to catch overflow errors in g(x)</span></a>
<a class="sourceLine" id="cb42-21" title="21">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dcauchy</span>(x)</a>
<a class="sourceLine" id="cb42-22" title="22">theta.hat[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb42-23" title="23">se[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb42-24" title="24"></a>
<a class="sourceLine" id="cb42-25" title="25">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f3, inverse transform method</span></a>
<a class="sourceLine" id="cb42-26" title="26">x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb42-27" title="27">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb42-28" title="28">theta.hat[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb42-29" title="29">se[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb42-30" title="30"></a>
<a class="sourceLine" id="cb42-31" title="31">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f4, inverse transform method</span></a>
<a class="sourceLine" id="cb42-32" title="32">x &lt;-<span class="st"> </span><span class="kw">tan</span>(pi <span class="op">*</span><span class="st"> </span>u <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb42-33" title="33">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>pi))</a>
<a class="sourceLine" id="cb42-34" title="34">theta.hat[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb42-35" title="35">se[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</a>
<a class="sourceLine" id="cb42-36" title="36"></a>
<a class="sourceLine" id="cb42-37" title="37">res &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">theta=</span><span class="kw">round</span>(theta.hat,<span class="dv">3</span>), <span class="dt">se=</span><span class="kw">round</span>(se,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb42-38" title="38"><span class="kw">colnames</span>(res) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb42-39" title="39">knitr<span class="op">::</span><span class="kw">kable</span>(res, <span class="dt">format =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">align=</span><span class="st">&#39;c&#39;</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
f0
</th>
<th style="text-align:center;">
f1
</th>
<th style="text-align:center;">
f2
</th>
<th style="text-align:center;">
f3
</th>
<th style="text-align:center;">
f4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
theta
</td>
<td style="text-align:center;">
0.523
</td>
<td style="text-align:center;">
0.520
</td>
<td style="text-align:center;">
0.523
</td>
<td style="text-align:center;">
0.526
</td>
<td style="text-align:center;">
0.526
</td>
</tr>
<tr>
<td style="text-align:left;">
se
</td>
<td style="text-align:center;">
0.245
</td>
<td style="text-align:center;">
0.422
</td>
<td style="text-align:center;">
0.953
</td>
<td style="text-align:center;">
0.097
</td>
<td style="text-align:center;">
0.142
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-5.13-stratiﬁed-importance-sampling-estimate" class="section level3">
<h3>3.1.2 Example 5.13 ： stratiﬁed importance sampling estimate</h3>
<p>To solve this problem, I’ll follow the exercise description method to implement.</p>
<ul>
<li>step 1 : divide the real line into k intervals <span class="math inline">\((j/5,(j +1)/5)\)</span>, <span class="math inline">\(j =0 ,1,...,4\)</span></li>
<li>step 2 : for each subinterval <span class="math inline">\(g_j(x)=g(x)I_{(j/5,(j +1)/5]}(x),j=1,2,…,k\)</span></li>
<li>step 3 : for each subinterval <span class="math inline">\(f_j(x)=\frac{1-e^\left(-1\right)}{e^\left(-\frac{i}{k}\right)-e^\left(-\frac{i+1}{k}\right)}f(x),x\in (j/5,(j +1)/5]\)</span></li>
<li>step 4 : estimate <span class="math inline">\(\theta_j=\int_{\frac j5}^{\frac{j+1}5}g_j(x)dx\)</span> via importance function <span class="math inline">\(f_j(x)\)</span></li>
<li>step 5 : estimate it as <span class="math inline">\(\theta=\sum_{j=1}^k\theta_j\)</span></li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">M &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb43-2" title="2">k &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb43-3" title="3">N &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb43-4" title="4"></a>
<a class="sourceLine" id="cb43-5" title="5">a &lt;-<span class="st"> </span>(<span class="kw">seq</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>k</a>
<a class="sourceLine" id="cb43-6" title="6"></a>
<a class="sourceLine" id="cb43-7" title="7">g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb43-8" title="8"></a>
<a class="sourceLine" id="cb43-9" title="9">kcof &lt;-<span class="st"> </span><span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb43-10" title="10">  ans &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span>k))</a>
<a class="sourceLine" id="cb43-11" title="11">  ans</a>
<a class="sourceLine" id="cb43-12" title="12">}</a>
<a class="sourceLine" id="cb43-13" title="13"></a>
<a class="sourceLine" id="cb43-14" title="14">st.im &lt;-<span class="st"> </span><span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb43-15" title="15">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k)   <span class="co"># inverse transformation method</span></a>
<a class="sourceLine" id="cb43-16" title="16">  v &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">-</span>(<span class="kw">exp</span>(<span class="op">-</span>(i<span class="dv">-1</span>)<span class="op">/</span>k)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>i<span class="op">/</span>k))<span class="op">*</span>u)</a>
<a class="sourceLine" id="cb43-17" title="17">  fg &lt;-<span class="st"> </span><span class="kw">g</span>(v)<span class="op">/</span>(<span class="kw">kcof</span>(i)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>v)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb43-18" title="18">  fg</a>
<a class="sourceLine" id="cb43-19" title="19">}</a>
<a class="sourceLine" id="cb43-20" title="20">est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-21" title="21"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb43-22" title="22">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb43-23" title="23">    uu &lt;-<span class="st"> </span><span class="kw">st.im</span>(j)</a>
<a class="sourceLine" id="cb43-24" title="24">    est[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>est[i,<span class="dv">1</span>]<span class="op">+</span><span class="kw">mean</span>(uu)</a>
<a class="sourceLine" id="cb43-25" title="25">    est[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>est[i,<span class="dv">2</span>]<span class="op">+</span><span class="kw">sd</span>(uu)</a>
<a class="sourceLine" id="cb43-26" title="26">  }</a>
<a class="sourceLine" id="cb43-27" title="27">}</a>
<a class="sourceLine" id="cb43-28" title="28">ans &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">apply</span>(est,<span class="dv">2</span>,mean),<span class="kw">apply</span>(est,<span class="dv">2</span>,sd))</a>
<a class="sourceLine" id="cb43-29" title="29"><span class="kw">colnames</span>(ans) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;sd&#39;</span>)</a>
<a class="sourceLine" id="cb43-30" title="30"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb43-31" title="31">knitr<span class="op">::</span><span class="kw">kable</span>(ans,<span class="dt">format=</span><span class="st">&#39;html&#39;</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5247966
</td>
<td style="text-align:right;">
0.0169900
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0001885
</td>
<td style="text-align:right;">
0.0000797
</td>
</tr>
</tbody>
</table>
</div>
<div id="analysis-1" class="section level3">
<h3>3.1.3 Analysis</h3>
<p>By comparing the results of importance estimation and stratified importance estimation, we can find that the variance of stratified importance estimation is 0.01699 which is about 1/5 of the variance of the importance sampling.</p>
</div>
</div>
<div id="another-way-for-stratified-importance-estimation" class="section level2">
<h2>3.2 Another way for stratified importance estimation</h2>
<p>As it’s stated in Chap 5.8, I’ll divide the interval in another way.</p>
<ul>
<li>step 1 : divide the real line into k intervals <span class="math inline">\(I_j=[a_{j-1},a_j),j=1,2,…,k\)</span> where <span class="math inline">\(a_j=F^{-1}(\frac jk)=-ln(1-\frac j5(1-e^{-1})),j=1,2,…,k-1\)</span> and <span class="math inline">\(a_0=-\infty,a_k=\infty\)</span></li>
<li>step 2 : for each subinterval <span class="math inline">\(g_j(x)=g(x)I_{[a_{j-1},a_j)}(x),j=1,2,…,k\)</span></li>
<li>step 3 : for each subinterval <span class="math inline">\(f_j(x)=kf(x),x\in I_j\)</span></li>
<li>step 4 : estimate <span class="math inline">\(\theta_j=\int_{a_{j-1}}^{a_j}g_j(x)dx\)</span> via importance function <span class="math inline">\(f_j(x)\)</span></li>
<li>step 5 : estimate it as <span class="math inline">\(\theta=\sum_{j=1}^k\theta_j\)</span></li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">M &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb44-2" title="2">k &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb44-3" title="3">N &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb44-4" title="4"></a>
<a class="sourceLine" id="cb44-5" title="5">a &lt;-<span class="st"> </span><span class="kw">numeric</span>(k<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb44-6" title="6"><span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb44-7" title="7">  a[l]=<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>(l<span class="dv">-1</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">/</span>k)</a>
<a class="sourceLine" id="cb44-8" title="8">a[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb44-9" title="9">a[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb44-10" title="10"><span class="co"># divide the real line into k intervals</span></a>
<a class="sourceLine" id="cb44-11" title="11"></a>
<a class="sourceLine" id="cb44-12" title="12">g&lt;-<span class="cf">function</span>(x)<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb44-13" title="13"><span class="co"># integrated function</span></a>
<a class="sourceLine" id="cb44-14" title="14"></a>
<a class="sourceLine" id="cb44-15" title="15">st.im &lt;-<span class="st"> </span><span class="cf">function</span>(lower,upper){</a>
<a class="sourceLine" id="cb44-16" title="16">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k)   <span class="co"># inverse transformation method</span></a>
<a class="sourceLine" id="cb44-17" title="17">  v &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>lower)<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))<span class="op">*</span>u<span class="op">/</span>k)</a>
<a class="sourceLine" id="cb44-18" title="18">  fg &lt;-<span class="st"> </span><span class="kw">g</span>(v)<span class="op">/</span>(k<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>v)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb44-19" title="19">  fg</a>
<a class="sourceLine" id="cb44-20" title="20">}</a>
<a class="sourceLine" id="cb44-21" title="21"><span class="co"># samples from interval [lower,upper)</span></a>
<a class="sourceLine" id="cb44-22" title="22"></a>
<a class="sourceLine" id="cb44-23" title="23">est &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-24" title="24"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb44-25" title="25">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb44-26" title="26">    uu &lt;-<span class="st"> </span><span class="kw">st.im</span>(a[j],a[j<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb44-27" title="27">    est[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>est[i,<span class="dv">1</span>]<span class="op">+</span><span class="kw">mean</span>(uu)</a>
<a class="sourceLine" id="cb44-28" title="28">    est[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>est[i,<span class="dv">2</span>]<span class="op">+</span><span class="kw">sd</span>(uu)</a>
<a class="sourceLine" id="cb44-29" title="29">  }</a>
<a class="sourceLine" id="cb44-30" title="30">}</a>
<a class="sourceLine" id="cb44-31" title="31">ans &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">apply</span>(est,<span class="dv">2</span>,mean),<span class="kw">apply</span>(est,<span class="dv">2</span>,sd))</a>
<a class="sourceLine" id="cb44-32" title="32"><span class="kw">colnames</span>(ans) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;mean&#39;</span>,<span class="st">&#39;sd&#39;</span>)</a>
<a class="sourceLine" id="cb44-33" title="33"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb44-34" title="34">knitr<span class="op">::</span><span class="kw">kable</span>(ans,<span class="dt">format=</span><span class="st">&#39;html&#39;</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5248240
</td>
<td style="text-align:right;">
0.0183131
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0001893
</td>
<td style="text-align:right;">
0.0000942
</td>
</tr>
</tbody>
</table>
<p>We can find that the variance is 0.0183131,which approximates the variance of another way.</p>
</div>
</div>
<div id="hw-2019-10-18" class="section level1">
<h1>HW 2019-10-18</h1>
<div id="question-exercise-6.5" class="section level2">
<h2>Question : Exercise 6.5</h2>
<ul>
<li>Suppose a <span class="math inline">\(95\%\)</span> symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the conﬁdence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95\)</span>.</li>
<li>Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n=20\)</span>.</li>
<li>Compare your t-interval results with the simulation results in Example 6.4.(The t-interval should be more robust to departures from normality than the interval for variance.)</li>
</ul>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p><strong>Monte Carlo experiment to estimate a conﬁdence level</strong></p>
<ul>
<li>Suppose that <span class="math inline">\(X \sim F_X\)</span> is the random variable of interest and that <span class="math inline">\(\theta\)</span> is the target parameter to be estimated.
<ul>
<li>1.For each replicate, indexed <span class="math inline">\(i=1,...,m\)</span> :
<ul>
<li>(a)Generate the jth random sample, <span class="math inline">\(X^{(i)}=(X^{(i)}_1 ,...,X^{(i)}_n)\)</span>.</li>
<li>(b)Compute the conﬁdence interval <span class="math inline">\(C_i\)</span> for the jth sample.</li>
<li>(c)Compute <span class="math inline">\(y_i=I(\theta\in C_i)\)</span> for thejth sample.</li>
</ul></li>
<li>2.Compute the empirical conﬁdence level <span class="math inline">\(\bar y=\frac1m\sum_{i=1}^my_i\)</span>.</li>
</ul></li>
<li>In this exercise:
<ul>
<li><span class="math inline">\(C_i=(\bar X^{(i)}+t_{\alpha/2}(n-1)sd(X^{(i)})/\sqrt n,\bar X^{(i)}+t_{1-\alpha/2}(n-1)sd(X^{(i)})/\sqrt n)\)</span></li>
<li><span class="math inline">\(E(\chi^2(v))=v\)</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">ecp.chi2 &lt;-<span class="st"> </span><span class="cf">function</span>(n, m, v, alpha){</a>
<a class="sourceLine" id="cb45-2" title="2">  <span class="co"># coverage probability of CI,sample size n,replicate m,confidence level 1-alpha</span></a>
<a class="sourceLine" id="cb45-3" title="3">  ecp &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb45-4" title="4">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb45-5" title="5">    x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> v) <span class="co"># sample from chi(v)</span></a>
<a class="sourceLine" id="cb45-6" title="6">    lcl &lt;-<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n) <span class="co"># lower conﬁdence limit</span></a>
<a class="sourceLine" id="cb45-7" title="7">    ucl &lt;-<span class="st"> </span><span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n) <span class="co"># upper conﬁdence limit</span></a>
<a class="sourceLine" id="cb45-8" title="8">    <span class="cf">if</span>(lcl <span class="op">&lt;=</span><span class="st"> </span>v){</a>
<a class="sourceLine" id="cb45-9" title="9">        <span class="cf">if</span>(v <span class="op">&lt;=</span><span class="st"> </span>ucl){</a>
<a class="sourceLine" id="cb45-10" title="10">          ecp[i] &lt;-<span class="st"> </span><span class="dv">1</span>  </a>
<a class="sourceLine" id="cb45-11" title="11">        }</a>
<a class="sourceLine" id="cb45-12" title="12">    } <span class="co"># cp for a MC experiment replicate</span></a>
<a class="sourceLine" id="cb45-13" title="13">  }</a>
<a class="sourceLine" id="cb45-14" title="14">  cp &lt;-<span class="st"> </span><span class="kw">mean</span>(ecp)</a>
<a class="sourceLine" id="cb45-15" title="15">  cp</a>
<a class="sourceLine" id="cb45-16" title="16">}</a>
<a class="sourceLine" id="cb45-17" title="17">ecp &lt;-<span class="st"> </span><span class="kw">ecp.chi2</span>(<span class="dv">20</span>, <span class="dv">1000</span>, <span class="dv">2</span>, <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb45-18" title="18">ecp</a></code></pre></div>
<pre><code>## [1] 0.919</code></pre>
<p><strong>Simulation results in Example 4</strong></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb47-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb47-3" title="3">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> { </a>
<a class="sourceLine" id="cb47-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>) </a>
<a class="sourceLine" id="cb47-5" title="5">  (n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>) </a>
<a class="sourceLine" id="cb47-6" title="6">  })  </a>
<a class="sourceLine" id="cb47-7" title="7">ecp.eg4 &lt;-<span class="st"> </span><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) </a></code></pre></div>
<p><strong>Analysis</strong></p>
<ul>
<li>The empirical conﬁdence level is 0.919 in this experiment. In this experiment the interval for variance, from Page 162, only 0.78 of the intervals contained the population variance, which is far from the <span class="math inline">\(0.95\)</span> coverage under normality.</li>
<li>The t-interval is more robust to departures from normality than the interval for variance.</li>
</ul>
</div>
<div id="question-2-exercise-6.6" class="section level2">
<h2>Question 2 : Exercise 6.6</h2>
<ul>
<li>Estimate the <span class="math inline">\(0.025\)</span>, <span class="math inline">\(0.05\)</span>, <span class="math inline">\(0.95\)</span>, and <span class="math inline">\(0.975\)</span> quantiles of the skewness <span class="math inline">\(\sqrt {b_1}\)</span> under normality by a Monte Carlo experiment.</li>
<li>Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula).</li>
<li>Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt {b_1}\sim N(0,\frac 6n)\)</span>.</li>
</ul>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<ul>
<li>1.For each replicate, indexed <span class="math inline">\(i=1,...,m\)</span> :
<ul>
<li>(a)Generate the jth random sample, <span class="math inline">\(X^{(i)}=(X^{(i)}_1 ,...,X^{(i)}_n)\)</span>.</li>
<li>(b)Compute the skewness <span class="math inline">\(\sqrt{b_1^{(j)}}=\frac{\frac1n\sum_{j=1}^m(X^{(i)}_j-\bar X_{.}^{(i)})^3}{(\frac1n\sum_{j=1}^m(X^{(i)}_j-\bar X_{.}^{(i)})^2)^{(\frac32)}}\)</span>.</li>
</ul></li>
<li>2.Compute the quantile of <span class="math inline">\(\sqrt{b_1}\)</span>.</li>
<li>3.Compute the standard error of the estimates <span class="math inline">\(Var(\hat X_q)=\frac {q(1-q)}{nf(X_q)^2}\)</span>, where <span class="math inline">\(f(X_q)\)</span> is pdf of <span class="math inline">\(N(0,\frac{6(n-2)}{(n+1)(n+3)})\)</span></li>
</ul>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb48-2" title="2">  <span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb48-3" title="3">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb48-4" title="4">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb48-5" title="5">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb48-6" title="6">  <span class="kw">return</span>(m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span>) </a>
<a class="sourceLine" id="cb48-7" title="7">} </a>
<a class="sourceLine" id="cb48-8" title="8"></a>
<a class="sourceLine" id="cb48-9" title="9">MC_sk &lt;-<span class="st"> </span><span class="cf">function</span>(n, m){</a>
<a class="sourceLine" id="cb48-10" title="10">  <span class="co">#a MC experiment of m replicate,with n sample from population</span></a>
<a class="sourceLine" id="cb48-11" title="11">  <span class="co">#estimate skewness of each replicate</span></a>
<a class="sourceLine" id="cb48-12" title="12">  MC_skewness &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb48-13" title="13">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb48-14" title="14">    replicate_MC &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb48-15" title="15">    MC_skewness[i] &lt;-<span class="st"> </span><span class="kw">sk</span>(replicate_MC)</a>
<a class="sourceLine" id="cb48-16" title="16">  }</a>
<a class="sourceLine" id="cb48-17" title="17">  MC_skewness</a>
<a class="sourceLine" id="cb48-18" title="18">}</a>
<a class="sourceLine" id="cb48-19" title="19"></a>
<a class="sourceLine" id="cb48-20" title="20">level &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb48-21" title="21">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb48-22" title="22">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb48-23" title="23">q_sk &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">MC_sk</span>(n, m), level)</a>
<a class="sourceLine" id="cb48-24" title="24">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(level, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb48-25" title="25">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">cbind</span>(q_sk,cv)), <span class="dt">format =</span> <span class="st">&#39;html&#39;</span>, <span class="dt">caption =</span> <span class="st">&#39;Quantile&#39;</span>)</a></code></pre></div>
<table>
<caption>
Quantile
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
5%
</th>
<th style="text-align:right;">
95%
</th>
<th style="text-align:right;">
97.5%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
q_sk
</td>
<td style="text-align:right;">
-0.9737533
</td>
<td style="text-align:right;">
-0.8090635
</td>
<td style="text-align:right;">
0.7719979
</td>
<td style="text-align:right;">
0.9085267
</td>
</tr>
<tr>
<td style="text-align:left;">
cv
</td>
<td style="text-align:right;">
-1.0735165
</td>
<td style="text-align:right;">
-0.9009234
</td>
<td style="text-align:right;">
0.9009234
</td>
<td style="text-align:right;">
1.0735165
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">sd_hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(level<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>level)<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(q_sk,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))<span class="op">^</span><span class="dv">2</span>)) <span class="co"># Compute the standard error of the estimates</span></a>
<a class="sourceLine" id="cb49-2" title="2">sd_hat</a></code></pre></div>
<pre><code>##      2.5%        5%       95%     97.5% 
## 0.3448318 0.2496585 0.2189955 0.2620456</code></pre>
<p><strong>Analysis</strong></p>
<ul>
<li>We can find that the simulated estimation of quantile is approximate to the real quantile under normality.</li>
<li>The standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula) is 0.3448318, 0.2496585, 0.2189955, 0.2620456 when q=0.025, 0.05, 0.95, 0.975.</li>
</ul>
</div>
</div>
<div id="hw-2019-11-02" class="section level1">
<h1>HW 2019-11-02</h1>
<div id="exercise-6.7" class="section level2">
<h2>Exercise 6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(ν)\)</span>?</p>
</div>
<div id="solution-1" class="section level2">
<h2>Solution 1</h2>
<ul>
<li><ol style="list-style-type: decimal">
<li>The population is Beta(<span class="math inline">\(\alpha_{1},\alpha_{2}\)</span>).</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1107</span>)</a>
<a class="sourceLine" id="cb51-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb51-3" title="3">  <span class="co">#computes the sample skewness </span></a>
<a class="sourceLine" id="cb51-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb51-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb51-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb51-7" title="7">  <span class="kw">return</span>(m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span>) </a>
<a class="sourceLine" id="cb51-8" title="8">} </a>
<a class="sourceLine" id="cb51-9" title="9">Powersktest1 &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb51-10" title="10">  n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb51-11" title="11">  cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>))) </a>
<a class="sourceLine" id="cb51-12" title="12">  <span class="co">#crit. values for each n</span></a>
<a class="sourceLine" id="cb51-13" title="13">  p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(a)) <span class="co">#to store sim. results </span></a>
<a class="sourceLine" id="cb51-14" title="14">  m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></a>
<a class="sourceLine" id="cb51-15" title="15">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(a)) { </a>
<a class="sourceLine" id="cb51-16" title="16">    sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></a>
<a class="sourceLine" id="cb51-17" title="17">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb51-18" title="18">      x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,<span class="dv">2</span>,a[i]) <span class="co">#test decision is 1 (reject) or 0</span></a>
<a class="sourceLine" id="cb51-19" title="19">      sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb51-20" title="20">      } </a>
<a class="sourceLine" id="cb51-21" title="21">    p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected </span></a>
<a class="sourceLine" id="cb51-22" title="22">    }</a>
<a class="sourceLine" id="cb51-23" title="23"><span class="kw">return</span>(p.reject)</a>
<a class="sourceLine" id="cb51-24" title="24">}</a>
<a class="sourceLine" id="cb51-25" title="25">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">2.5</span>,<span class="dv">10</span>,.<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb51-26" title="26"><span class="kw">plot</span>(<span class="kw">cbind</span>(<span class="st">&#39;alpha 2&#39;</span>=a,<span class="st">&#39;power&#39;</span>=<span class="kw">Powersktest1</span>(a)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We found that when <span class="math inline">\(\alpha_{2}\)</span> incereses, power increases. When <span class="math inline">\(\alpha_{2}\)</span> is up to 10, the power function is less than 0.3.</p>
<ul>
<li><ol start="2" style="list-style-type: decimal">
<li>The population is t(<span class="math inline">\(v\)</span>).</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">Powersktest2 &lt;-<span class="st"> </span><span class="cf">function</span>(a2){</a>
<a class="sourceLine" id="cb52-2" title="2">  a1 &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb52-3" title="3">  n &lt;-<span class="st"> </span><span class="dv">20</span> <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb52-4" title="4">  cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>))) <span class="co">#crit. values for each n</span></a>
<a class="sourceLine" id="cb52-5" title="5">  p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(v)) <span class="co">#to store sim. results </span></a>
<a class="sourceLine" id="cb52-6" title="6">  m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></a>
<a class="sourceLine" id="cb52-7" title="7">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(v)) { </a>
<a class="sourceLine" id="cb52-8" title="8">    sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></a>
<a class="sourceLine" id="cb52-9" title="9">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb52-10" title="10">      x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,v[i]) <span class="co">#test decision is 1 (reject) or 0</span></a>
<a class="sourceLine" id="cb52-11" title="11">      sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb52-12" title="12">      } </a>
<a class="sourceLine" id="cb52-13" title="13">    p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected </span></a>
<a class="sourceLine" id="cb52-14" title="14">    }</a>
<a class="sourceLine" id="cb52-15" title="15"><span class="kw">return</span>(p.reject)</a>
<a class="sourceLine" id="cb52-16" title="16">}</a>
<a class="sourceLine" id="cb52-17" title="17"></a>
<a class="sourceLine" id="cb52-18" title="18">v &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.5</span>,<span class="dv">10</span>,.<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-19" title="19"><span class="kw">plot</span>(<span class="kw">cbind</span>(v,<span class="st">&#39;power&#39;</span>=<span class="kw">Powersktest2</span>(v)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>We found that when the t-distribution is between 4 and 10 degrees of freedom, power is around 0.2 and only when degrees of freedom are samll the power function is large.</li>
</ul>
</div>
<div id="solution-2-the-ieda-comes-from-ex-6.10." class="section level2">
<h2>Solution 2 : The ieda comes from Ex 6.10.</h2>
<ul>
<li><ol style="list-style-type: decimal">
<li>In this example, we estimate by simulation the power of the skewness test of normality against a contaminatedbeta alternative. The contaminated beta distribution is denoted by <span class="math inline">\((1−\epsilon)Beta(\alpha=1,\beta=1)+\epsilon Beta(\alpha=500,\beta=500),0\le\epsilon\le1.\)</span></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.1</span> </a>
<a class="sourceLine" id="cb53-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span> </a>
<a class="sourceLine" id="cb53-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2500</span> </a>
<a class="sourceLine" id="cb53-4" title="4">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>)) </a>
<a class="sourceLine" id="cb53-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon) </a>
<a class="sourceLine" id="cb53-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) <span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb53-7" title="7">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb53-8" title="8"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb53-9" title="9">  <span class="co">#for each epsilon </span></a>
<a class="sourceLine" id="cb53-10" title="10">  e &lt;-<span class="st"> </span>epsilon[j] </a>
<a class="sourceLine" id="cb53-11" title="11">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb53-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb53-13" title="13">    <span class="co">#for each replicate </span></a>
<a class="sourceLine" id="cb53-14" title="14">    a &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">500</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e)) </a>
<a class="sourceLine" id="cb53-15" title="15">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n, a, a) </a>
<a class="sourceLine" id="cb53-16" title="16">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb53-17" title="17">    } </a>
<a class="sourceLine" id="cb53-18" title="18">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) } </a>
<a class="sourceLine" id="cb53-19" title="19"><span class="co">#plot power vs epsilon </span></a>
<a class="sourceLine" id="cb53-20" title="20"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb53-21" title="21"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb53-22" title="22">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </a>
<a class="sourceLine" id="cb53-23" title="23"><span class="co">#add standard errors </span></a>
<a class="sourceLine" id="cb53-24" title="24"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb53-25" title="25"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>Empirical power <span class="math inline">\(\hat\pi(\epsilon)+\hat{se}(\hat\pi(\epsilon))\)</span> for the skewnesstest of normality against <span class="math inline">\(\epsilon\)</span>-contaminated beta scale mixture alternative.The empirical power curve is shown in Figure above.
<ul>
<li>Note that the power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha\)</span> =0.10 at both endpoints, <span class="math inline">\(\epsilon\)</span>=0 and <span class="math inline">\(\epsilon\)</span>=1 where the alternative is beta distributed. For <span class="math inline">\(0.5&lt;\epsilon&lt;1\)</span> the empirical power of the test is greater than 0.10 and highest when ε is about 0.9. ) for the skewnesstest of normality against ε-contaminated beta scale mixture alternative.</li>
</ul></li>
<li><ol start="2" style="list-style-type: decimal">
<li>In this example, we estimate by simulation the power of the skewness test of normality against a contaminatedt alternative. The contaminated student t distribution is denoted by <span class="math inline">\((1−\epsilon)t(v)+\epsilon t(v),0\le\epsilon\le1.\)</span></li>
</ol></li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.1</span> </a>
<a class="sourceLine" id="cb54-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span> </a>
<a class="sourceLine" id="cb54-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2500</span> </a>
<a class="sourceLine" id="cb54-4" title="4">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>)) </a>
<a class="sourceLine" id="cb54-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon) </a>
<a class="sourceLine" id="cb54-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) <span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb54-7" title="7">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb54-8" title="8"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { </a>
<a class="sourceLine" id="cb54-9" title="9">  <span class="co">#for each epsilon </span></a>
<a class="sourceLine" id="cb54-10" title="10">  e &lt;-<span class="st"> </span>epsilon[j] </a>
<a class="sourceLine" id="cb54-11" title="11">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb54-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb54-13" title="13">    <span class="co">#for each replicate </span></a>
<a class="sourceLine" id="cb54-14" title="14">    v &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e)) </a>
<a class="sourceLine" id="cb54-15" title="15">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n, v) </a>
<a class="sourceLine" id="cb54-16" title="16">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb54-17" title="17">    } </a>
<a class="sourceLine" id="cb54-18" title="18">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) } </a>
<a class="sourceLine" id="cb54-19" title="19"><span class="co">#plot power vs epsilon </span></a>
<a class="sourceLine" id="cb54-20" title="20"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb54-21" title="21"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb54-22" title="22">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) </a>
<a class="sourceLine" id="cb54-23" title="23"><span class="co">#add standard errors </span></a>
<a class="sourceLine" id="cb54-24" title="24"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb54-25" title="25"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>Empirical power <span class="math inline">\(\hat\pi(\epsilon)+\hat{se}(\hat\pi(\epsilon))\)</span> for the skewnesstest of normality against <span class="math inline">\(\epsilon\)</span>-contaminated beta scale mixture alternative.The empirical power curve is shown in Figure above.
<ul>
<li>Note that the power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha\)</span> =0.10 at both endpoints, <span class="math inline">\(\epsilon\)</span>=0 and <span class="math inline">\(\epsilon\)</span>=1 where the alternative is t distributed. For <span class="math inline">\(0&lt;\epsilon&lt;1\)</span> the empirical power of the test is greater than 0.10 and highest when ε is about 0.) for the skewnesstest of normality against ε-contaminated t scale mixture alternative.</li>
</ul></li>
</ul>
</div>
<div id="exercise-6.a" class="section level2">
<h2>Exercise 6.A</h2>
<ul>
<li>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal signiﬁcance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is
<ul>
<li><span class="math inline">\((1)\)</span> <span class="math inline">\(\chi^{2}(1)\)</span>,</li>
<li><span class="math inline">\((2)\)</span> <span class="math inline">\(U(0,2)\)</span>,<br />
</li>
<li><span class="math inline">\((3)\)</span> <span class="math inline">\(Exp(1)\)</span>.</li>
</ul></li>
<li>In each case, test <span class="math inline">\(H_{0}:\mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{0}:\mu\not=\mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, <span class="math inline">\(Uniform(0,2)\)</span>, and Exponential(1), respectively.</li>
</ul>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">t1e &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">n &lt;-<span class="st"> </span><span class="dv">200</span> </a>
<a class="sourceLine" id="cb55-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span> </a></code></pre></div>
<ul>
<li><ol style="list-style-type: decimal">
<li>The sampled population is<span class="math inline">\(\chi^{2}(1)\)</span>.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> { </a>
<a class="sourceLine" id="cb56-2" title="2">  <span class="co">#simulate under alternative mu1 </span></a>
<a class="sourceLine" id="cb56-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb56-4" title="4">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb56-5" title="5">  ttest<span class="op">$</span>p.value     </a>
<a class="sourceLine" id="cb56-6" title="6">  })</a>
<a class="sourceLine" id="cb56-7" title="7">t1e[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.05</span>) </a>
<a class="sourceLine" id="cb56-8" title="8">t1e[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<ul>
<li><ol start="2" style="list-style-type: decimal">
<li>The sampled population is <span class="math inline">\(U(0,2)\)</span>.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> { </a>
<a class="sourceLine" id="cb58-2" title="2">  <span class="co">#simulate under alternative mu1 </span></a>
<a class="sourceLine" id="cb58-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">max =</span> <span class="dv">2</span>,<span class="dt">min =</span> <span class="dv">0</span>) </a>
<a class="sourceLine" id="cb58-4" title="4">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb58-5" title="5">  ttest<span class="op">$</span>p.value     </a>
<a class="sourceLine" id="cb58-6" title="6">  })</a>
<a class="sourceLine" id="cb58-7" title="7">t1e[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.05</span>) </a>
<a class="sourceLine" id="cb58-8" title="8">t1e[<span class="dv">2</span>]</a></code></pre></div>
<pre><code>## [1] 0.048</code></pre>
<ul>
<li><ol start="3" style="list-style-type: decimal">
<li>The sampled population is <span class="math inline">\(Exp(1)\)</span>.</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">pvalues &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> { </a>
<a class="sourceLine" id="cb60-2" title="2">  <span class="co">#simulate under alternative mu1 </span></a>
<a class="sourceLine" id="cb60-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb60-4" title="4">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb60-5" title="5">  ttest<span class="op">$</span>p.value     </a>
<a class="sourceLine" id="cb60-6" title="6">  })</a>
<a class="sourceLine" id="cb60-7" title="7">t1e[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(pvalues <span class="op">&lt;=</span><span class="st"> </span><span class="fl">.05</span>) </a>
<a class="sourceLine" id="cb60-8" title="8">t1e[<span class="dv">3</span>]</a></code></pre></div>
<pre><code>## [1] 0.048</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">distribution &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;chisq(1)&#39;</span>,<span class="st">&#39;unif(0,2)&#39;</span>,<span class="st">&#39;exp(1)&#39;</span>)</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">rbind</span>(distribution,<span class="st">&#39;type 1 error&#39;</span> =<span class="st"> </span>t1e)</a></code></pre></div>
<pre><code>##              [,1]       [,2]        [,3]    
## distribution &quot;chisq(1)&quot; &quot;unif(0,2)&quot; &quot;exp(1)&quot;
## type 1 error &quot;0.05&quot;     &quot;0.048&quot;     &quot;0.048&quot;</code></pre>
<ul>
<li>We can find that the empirical Type I error rate of the t-test is approximately approximate equal to the nominal signiﬁcance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal.</li>
<li>The t-test is robust to mild departures from normality. When the sampled population is <span class="math inline">\(\chi^{2}(1)\)</span>, <span class="math inline">\(U(0,2)\)</span>, <span class="math inline">\(Exp(1)\)</span>.</li>
</ul>
</div>
<div id="exercise-discussion-from-slide-p22" class="section level2">
<h2>Exercise : Discussion from slide P22</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? + What is the corresponding hypothesis test problem? + What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? + What information is needed to test your hypothesis?</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<ul>
<li>The corrsponding hypothesis test is <span class="math inline">\(H_{0}:power_{1}=power_{2}\)</span></li>
<li>We should use paired-t test.</li>
<li>The information needed is
<ul>
<li><span class="math inline">\(X_{11},...,X_{1n}\)</span> and <span class="math inline">\(X_{21},...,X_{2n}\)</span></li>
<li>The distribution of test statistic.</li>
</ul></li>
</ul>
</div>
</div>
<div id="hw-2019-11-08" class="section level1">
<h1>HW 2019-11-08</h1>
<div id="exercise-7.6" class="section level2">
<h2>Exercise 7.6</h2>
<ul>
<li>Efron and Tibshirani discuss the scor(bootstrap) test score data on 88 students who took examinations in ﬁve subjects [84, Table7.1], [188, Table1.2.1]. The ﬁrst two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1},x_{i2},x_{i3},x_{i4},x_{i5})\)</span> for the <span class="math inline">\(i^{th}\)</span> student.
<ul>
<li>Use a panel display to display the scatter plots for each pair of test scores.</li>
<li>Compare the plot with the sample correlation matrix.</li>
<li>Obtain bootstrap estimates of the standard errors for each of the following estimates:
<ul>
<li><span class="math inline">\(\hat\rho_{12}=\hat\rho(mec, vec)\)</span>,</li>
<li><span class="math inline">\(\hat\rho_{34}=\hat\rho(alg, ana)\)</span>,</li>
<li><span class="math inline">\(\hat\rho_{35}=\hat\rho(alg, sta)\)</span>,</li>
<li><span class="math inline">\(\hat\rho_{45}=\hat\rho(ana, sta)\)</span>.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">data</span>(scor)</a>
<a class="sourceLine" id="cb64-3" title="3"><span class="kw">plot</span>(scor) <span class="co">#the scatter plots for each pair of test scores</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">cor</span>(scor) <span class="co">#the sample correlation matrix</span></a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">set.seed</span>(<span class="dv">9986</span>)</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="kw">library</span>(boot) <span class="co">#for boot function</span></a>
<a class="sourceLine" id="cb67-3" title="3"></a>
<a class="sourceLine" id="cb67-4" title="4">cor_<span class="dv">12</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){ </a>
<a class="sourceLine" id="cb67-5" title="5">  <span class="co">#want correlation of columns 1 and 2 </span></a>
<a class="sourceLine" id="cb67-6" title="6">  <span class="kw">cor</span>(x[i,<span class="dv">1</span>], x[i,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb67-7" title="7">}</a>
<a class="sourceLine" id="cb67-8" title="8">obj1 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> cor_<span class="dv">12</span>, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb67-9" title="9"></a>
<a class="sourceLine" id="cb67-10" title="10">cor_<span class="dv">34</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){ </a>
<a class="sourceLine" id="cb67-11" title="11">  <span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb67-12" title="12">}</a>
<a class="sourceLine" id="cb67-13" title="13">obj2 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> cor_<span class="dv">34</span>, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb67-14" title="14"></a>
<a class="sourceLine" id="cb67-15" title="15">cor_<span class="dv">35</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){ </a>
<a class="sourceLine" id="cb67-16" title="16">  <span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb67-17" title="17">}</a>
<a class="sourceLine" id="cb67-18" title="18">obj3 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> cor_<span class="dv">35</span>, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb67-19" title="19"></a>
<a class="sourceLine" id="cb67-20" title="20">cor_<span class="dv">45</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x, i){ </a>
<a class="sourceLine" id="cb67-21" title="21">  <span class="kw">cor</span>(x[i,<span class="dv">4</span>], x[i,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb67-22" title="22">}</a>
<a class="sourceLine" id="cb67-23" title="23">obj4 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> cor_<span class="dv">45</span>, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb67-24" title="24"></a>
<a class="sourceLine" id="cb67-25" title="25">bootstrap_cor &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(obj1<span class="op">$</span>t),<span class="kw">mean</span>(obj2<span class="op">$</span>t),<span class="kw">mean</span>(obj3<span class="op">$</span>t),<span class="kw">mean</span>(obj4<span class="op">$</span>t))</a>
<a class="sourceLine" id="cb67-26" title="26">s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sd</span>(obj1<span class="op">$</span>t),<span class="kw">sd</span>(obj2<span class="op">$</span>t),<span class="kw">sd</span>(obj3<span class="op">$</span>t),<span class="kw">sd</span>(obj4<span class="op">$</span>t))</a>
<a class="sourceLine" id="cb67-27" title="27">s_c &lt;-<span class="st"> </span><span class="kw">cor</span>(scor)</a>
<a class="sourceLine" id="cb67-28" title="28">sample_cor=<span class="kw">c</span>(<span class="dt">cor12=</span>s_c[<span class="dv">1</span>,<span class="dv">2</span>],<span class="dt">cor34=</span>s_c[<span class="dv">3</span>,<span class="dv">4</span>],<span class="dt">cor35=</span>s_c[<span class="dv">3</span>,<span class="dv">5</span>],<span class="dt">cor45=</span>s_c[<span class="dv">4</span>,<span class="dv">5</span>])</a>
<a class="sourceLine" id="cb67-29" title="29"></a>
<a class="sourceLine" id="cb67-30" title="30"><span class="kw">rbind</span>(sample_cor,bootstrap_cor,<span class="dt">se_estimation=</span>s)</a></code></pre></div>
<pre><code>##                    cor12      cor34      cor35      cor45
## sample_cor    0.55340518 0.71080586 0.66473573 0.60717429
## bootstrap_cor 0.55037629 0.70946192 0.66386208 0.60782208
## se_estimation 0.07612162 0.04801977 0.06054732 0.06805025</code></pre>
<ul>
<li><p>From the scatter diagram, we can see that the correlation between the first two variables and the last three variables is relatively strong, while the correlation between the first two variables and the last three variables is not strong.</p></li>
<li><p>Comparing the sample covariance matrix, we can get the same conclusion as the above one.</p></li>
<li><p>Finally, we give the sample estimators, bootstrap estimators and estimators of bootstrap standard errors of these four statistics.</p></li>
</ul>
</div>
<div id="project-7.b" class="section level2">
<h2>Project 7.B</h2>
<ul>
<li>Repeat Project 7.A for the sample skewness statistic.</li>
<li>Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness).</li>
</ul>
</div>
<div id="recall-7.a" class="section level2">
<h2>Recall 7.A</h2>
<ul>
<li>Conduct a Monte Carlo study to estimate the coverage probabilities of the standard normal bootstrap conﬁdence interval, the basic bootstrap conﬁdence interval, and the percentile conﬁdence interval.</li>
<li>Sample from a normal population and check the empirical coverage rates for the sample mean. Find the proportion of times that the conﬁdence intervals miss on the left, and the porportion of times that the conﬁdence intervals miss on the right.</li>
</ul>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(boot) <span class="co">#for boot and boot.ci </span></a>
<a class="sourceLine" id="cb69-2" title="2"><span class="kw">set.seed</span>(<span class="dv">666</span>)</a>
<a class="sourceLine" id="cb69-3" title="3"></a>
<a class="sourceLine" id="cb69-4" title="4">mean.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat, ind) { </a>
<a class="sourceLine" id="cb69-5" title="5">  <span class="co">#function to compute the statistic mean</span></a>
<a class="sourceLine" id="cb69-6" title="6">  y &lt;-<span class="st"> </span>dat[ind] </a>
<a class="sourceLine" id="cb69-7" title="7">  <span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb69-8" title="8">}</a>
<a class="sourceLine" id="cb69-9" title="9"></a>
<a class="sourceLine" id="cb69-10" title="10">M=<span class="dv">200</span></a>
<a class="sourceLine" id="cb69-11" title="11">cr &lt;-<span class="st"> </span>ml &lt;-<span class="st"> </span>mr &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> M,<span class="dt">ncol =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb69-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</a>
<a class="sourceLine" id="cb69-13" title="13">  norm_s &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb69-14" title="14">  obj5 &lt;-<span class="st"> </span><span class="kw">boot</span>(norm_s, <span class="dt">statistic =</span> mean.boot, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb69-15" title="15">  a1 &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(obj5, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb69-16" title="16">  </a>
<a class="sourceLine" id="cb69-17" title="17">  <span class="co"># the empirical coverage rates for the sample mean</span></a>
<a class="sourceLine" id="cb69-18" title="18">  cr[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(a1[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>a1[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">3</span>]<span class="op">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-19" title="19">  cr[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(a1[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>a1[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-20" title="20">  cr[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(a1[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>a1[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-21" title="21">  </a>
<a class="sourceLine" id="cb69-22" title="22">  <span class="co"># the proportion of times that the conﬁdence intervals miss on the left</span></a>
<a class="sourceLine" id="cb69-23" title="23">  ml[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>(a1[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">3</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-24" title="24">  ml[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>(a1[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">5</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-25" title="25">  ml[i,<span class="dv">3</span>] &lt;-<span class="st"> </span>(a1[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">5</span>]<span class="op">&lt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-26" title="26">  </a>
<a class="sourceLine" id="cb69-27" title="27">  <span class="co"># the porportion of times that the conﬁdence intervals miss on the right</span></a>
<a class="sourceLine" id="cb69-28" title="28">  mr[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>(a1[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-29" title="29">  mr[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>(a1[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">4</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-30" title="30">  mr[i,<span class="dv">3</span>] &lt;-<span class="st"> </span>(a1[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">4</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb69-31" title="31">  </a>
<a class="sourceLine" id="cb69-32" title="32">}</a>
<a class="sourceLine" id="cb69-33" title="33"></a>
<a class="sourceLine" id="cb69-34" title="34">coverage_rate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">norm=</span><span class="kw">mean</span>(cr[,<span class="dv">1</span>]),<span class="dt">basic=</span><span class="kw">mean</span>(cr[,<span class="dv">2</span>]),<span class="dt">percent=</span><span class="kw">mean</span>(cr[,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb69-35" title="35">p_on_left &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">norm=</span><span class="kw">mean</span>(ml[,<span class="dv">1</span>]),<span class="dt">basic=</span><span class="kw">mean</span>(ml[,<span class="dv">2</span>]),<span class="dt">percent=</span><span class="kw">mean</span>(ml[,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb69-36" title="36">p_on_right &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">norm=</span><span class="kw">mean</span>(mr[,<span class="dv">1</span>]),<span class="dt">basic=</span><span class="kw">mean</span>(mr[,<span class="dv">2</span>]),<span class="dt">percent=</span><span class="kw">mean</span>(mr[,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb69-37" title="37"></a>
<a class="sourceLine" id="cb69-38" title="38"><span class="kw">rbind</span>(coverage_rate,p_on_left,p_on_right)</a></code></pre></div>
<pre><code>##                norm basic percent
## coverage_rate 0.940 0.935   0.945
## p_on_left     0.015 0.020   0.015
## p_on_right    0.045 0.045   0.040</code></pre>
</div>
<div id="solution-of-project-7.b" class="section level2">
<h2>Solution of project 7.B</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">library</span>(boot) </a>
<a class="sourceLine" id="cb71-2" title="2"><span class="kw">set.seed</span>(<span class="dv">9986</span>)</a>
<a class="sourceLine" id="cb71-3" title="3"></a>
<a class="sourceLine" id="cb71-4" title="4">sk.boot &lt;-<span class="st"> </span><span class="cf">function</span>(dat,ind) {</a>
<a class="sourceLine" id="cb71-5" title="5">  <span class="co"># function to compute the statistic skewness </span></a>
<a class="sourceLine" id="cb71-6" title="6">  x &lt;-<span class="st"> </span>dat[ind]</a>
<a class="sourceLine" id="cb71-7" title="7">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb71-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb71-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb71-10" title="10">  <span class="kw">return</span>(m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span>) </a>
<a class="sourceLine" id="cb71-11" title="11">} </a>
<a class="sourceLine" id="cb71-12" title="12"></a>
<a class="sourceLine" id="cb71-13" title="13"></a>
<a class="sourceLine" id="cb71-14" title="14">M=<span class="dv">200</span></a>
<a class="sourceLine" id="cb71-15" title="15">crnorm &lt;-<span class="st"> </span>crchisq &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> M,<span class="dt">ncol =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb71-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</a>
<a class="sourceLine" id="cb71-17" title="17">  norm_s &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb71-18" title="18">  obj6 &lt;-<span class="st"> </span><span class="kw">boot</span>(norm_s, <span class="dt">statistic =</span> sk.boot, <span class="dt">R =</span> <span class="dv">2000</span>) <span class="co"># bootstrap</span></a>
<a class="sourceLine" id="cb71-19" title="19">  a2 &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(obj6, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>)) <span class="co"># bootstrap ci for 3 methods</span></a>
<a class="sourceLine" id="cb71-20" title="20">  </a>
<a class="sourceLine" id="cb71-21" title="21">  <span class="co"># the empirical coverage rates for the sample sk</span></a>
<a class="sourceLine" id="cb71-22" title="22">  crnorm[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>(a2[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>a2[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">3</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb71-23" title="23">  crnorm[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>(a2[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>a2[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb71-24" title="24">  crnorm[i,<span class="dv">3</span>] &lt;-<span class="st"> </span>(a2[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">0</span><span class="op">&amp;</span>a2[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb71-25" title="25">}</a>
<a class="sourceLine" id="cb71-26" title="26"></a>
<a class="sourceLine" id="cb71-27" title="27"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M) {</a>
<a class="sourceLine" id="cb71-28" title="28">  chi5_s &lt;-<span class="st"> </span><span class="kw">rchisq</span>(<span class="dv">100</span>,<span class="dt">df=</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb71-29" title="29">  obj7 &lt;-<span class="st"> </span><span class="kw">boot</span>(chi5_s, <span class="dt">statistic =</span> sk.boot, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb71-30" title="30">  a3 &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(obj7, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb71-31" title="31">  </a>
<a class="sourceLine" id="cb71-32" title="32">  <span class="co"># the empirical coverage rates for the sample sk</span></a>
<a class="sourceLine" id="cb71-33" title="33">  crchisq[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>(a3[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">2</span>]<span class="op">&lt;</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)<span class="op">&amp;</span>a3[[<span class="st">&quot;normal&quot;</span>]][<span class="dv">3</span>]<span class="op">&gt;</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb71-34" title="34">  crchisq[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>(a3[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)<span class="op">&amp;</span>a3[[<span class="st">&quot;basic&quot;</span>]][<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb71-35" title="35">  crchisq[i,<span class="dv">3</span>] &lt;-<span class="st"> </span>(a3[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">4</span>]<span class="op">&lt;</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)<span class="op">&amp;</span>a3[[<span class="st">&quot;percent&quot;</span>]][<span class="dv">5</span>]<span class="op">&gt;</span><span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb71-36" title="36">}</a>
<a class="sourceLine" id="cb71-37" title="37"></a>
<a class="sourceLine" id="cb71-38" title="38">norm_coverage_rate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">norm=</span><span class="kw">mean</span>(crnorm[,<span class="dv">1</span>]),<span class="dt">basic=</span><span class="kw">mean</span>(crnorm[,<span class="dv">2</span>]),<span class="dt">percent=</span><span class="kw">mean</span>(crnorm[,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb71-39" title="39">chi5_coverage_rate &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">norm=</span><span class="kw">mean</span>(crchisq[,<span class="dv">1</span>]),<span class="dt">basic=</span><span class="kw">mean</span>(crchisq[,<span class="dv">2</span>]),<span class="dt">percent=</span><span class="kw">mean</span>(crchisq[,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb71-40" title="40"></a>
<a class="sourceLine" id="cb71-41" title="41"><span class="kw">rbind</span>(norm_coverage_rate,chi5_coverage_rate)</a></code></pre></div>
<pre><code>##                     norm basic percent
## norm_coverage_rate 0.945 0.935   0.945
## chi5_coverage_rate 0.755 0.735   0.710</code></pre>
<ul>
<li>We can find that under bootstrap, the coverage rates of skewness confidence interval of chi-square distribution with a degree of freedom of 5 is about 0.75, far less than the nominal confidence level.</li>
<li>However, the coverage rates of skewness confidence interval of normal population is close to the nominal confidence level.</li>
<li>Moreover, in terms of confidence interval coverage rates, the confidence intervals obtained by the three methods have high similarity.</li>
</ul>
</div>
</div>
<div id="hw-2019-11-15" class="section level1">
<h1>HW 2019-11-15</h1>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta.\)</span></p>
</div>
<div id="recall-7.7" class="section level2">
<h2>Recall 7.7</h2>
<p>Refer to Exercise 7.6. Efron and Tibshirani discuss the following example[84, Ch.7]. The ﬁve-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_{1}&gt;\lambda_{2}&gt;...&gt;\lambda_{5}\)</span>. In principal components analysis, <span class="math inline">\(\theta=\frac{\lambda_{1}}{\sum_{i=1}^{5}\lambda_{i}}\)</span> measures the proportion of variance explained by the ﬁrst principal component. Let <span class="math inline">\(\hat\lambda_{1}&gt;\hat\lambda_{2}&gt;...&gt;\hat\lambda_{5}\)</span> be the eigenvalues of <span class="math inline">\(\hat\Sigma\)</span>, where <span class="math inline">\(\hat\Sigma\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. Compute the sample estimate <span class="math inline">\(\hat\theta=\frac{\hat\lambda_{1}}{\sum_{i=1}^{5}\hat\lambda_{i}}\)</span> of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">data</span>(scor)</a>
<a class="sourceLine" id="cb73-3" title="3"></a>
<a class="sourceLine" id="cb73-4" title="4">prop.var<span class="fl">.1</span>pc &lt;-<span class="st"> </span><span class="cf">function</span>(dat, ind){</a>
<a class="sourceLine" id="cb73-5" title="5">  <span class="co"># the proportion of variance explained by the ﬁrst principal component</span></a>
<a class="sourceLine" id="cb73-6" title="6">  sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(dat[ind,])</a>
<a class="sourceLine" id="cb73-7" title="7">  lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(sigma)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb73-8" title="8">  theta &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb73-9" title="9">  <span class="kw">return</span>(theta)</a>
<a class="sourceLine" id="cb73-10" title="10">}</a>
<a class="sourceLine" id="cb73-11" title="11"></a>
<a class="sourceLine" id="cb73-12" title="12">jack.bias.and.se &lt;-<span class="st"> </span><span class="cf">function</span>(dat, theta){</a>
<a class="sourceLine" id="cb73-13" title="13">  <span class="co"># function to get the jackknife estimates of bias and standard error of theta</span></a>
<a class="sourceLine" id="cb73-14" title="14">  <span class="co"># dat is the sample data;theta is the interseted parameter</span></a>
<a class="sourceLine" id="cb73-15" title="15">  n &lt;-<span class="st"> </span><span class="kw">dim</span>(dat)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb73-16" title="16">  theta.hat &lt;-<span class="st"> </span><span class="kw">theta</span>(dat, <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb73-17" title="17">   </a>
<a class="sourceLine" id="cb73-18" title="18">  theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) </a>
<a class="sourceLine" id="cb73-19" title="19">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){ </a>
<a class="sourceLine" id="cb73-20" title="20">    theta.jack[i] &lt;-<span class="st"> </span><span class="kw">theta</span>(dat, (<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</a>
<a class="sourceLine" id="cb73-21" title="21">  } </a>
<a class="sourceLine" id="cb73-22" title="22">  bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta.hat) </a>
<a class="sourceLine" id="cb73-23" title="23">  se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta.hat)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb73-24" title="24">  <span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">original=</span>theta.hat,<span class="dt">bias.jack=</span>bias.jack,<span class="dt">se.jack=</span>se.jack),<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb73-25" title="25">}</a>
<a class="sourceLine" id="cb73-26" title="26"></a>
<a class="sourceLine" id="cb73-27" title="27"><span class="kw">jack.bias.and.se</span>(scor,prop.var<span class="fl">.1</span>pc)</a></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<ul>
<li>The jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span> are obtained above.</li>
</ul>
</div>
<div id="exercise-7.10" class="section level2">
<h2>Exercise 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best ﬁtting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">attach</span>(ironslag) </a>
<a class="sourceLine" id="cb81-2" title="2">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb81-3" title="3"></a>
<a class="sourceLine" id="cb81-4" title="4"><span class="co">####par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb81-5" title="5"></a>
<a class="sourceLine" id="cb81-6" title="6">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical) </a>
<a class="sourceLine" id="cb81-7" title="7"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb81-8" title="8">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a </a>
<a class="sourceLine" id="cb81-9" title="9"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb82-3" title="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb82-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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z6fvtjnV4ITbr9znpzNBbjgg5Mar3DFIAvI+g6zbUX3BvE+crO6fgR+xZihww5c8Qm68KgJItndnqxc2hx3P43M/MZCnQSI/rYnfTSPYATd+LQZotDmwUTHa7ac5913u2sFX/VkfoKAmJuRa11Km0Xr9mJm2nuUxeShbXRMDUdEEZO+ku988+PzUZuDx9PWtj/UFadCvGhDtX+t5mSKnH2XicaN3raebP6lT9Y/Mul6Mn7A1uu636l2nn7OJ2414XKOAs56Bov4ua9/YvrPhz5e2ho5a5oBxBy4/honTjbHLezp+0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgVQHyPx3GujfPA2U8uiBAuT4SJwIEtBJAtciWP+y+38qElVqmru63f9u1G3vxrmRRd3n1XWrLjQCSzyd9POx44nP3j+dI7bciof7+mSfQCRadpcibktu3AEjkxKu/++0b+bq5fxaJZN1/bzgLbfnNO5ljdxuAVJKqKG37n0yXU+mX6j/xuG4jnbU5t7uCWgegLklVA+oWYrMAUumsbSi6//eN16DTmc2oBukdtwHoHIMkIF3qESBlKRP6b6aJif7o+LRRgMTrU9X93McEpCxl5RG/1bgJQHocpEY2/HVbScaA1DhIJPa2CG8F0HpFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wN1MUdLdRK+nAAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical) </a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb83-3" title="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a </a>
<a class="sourceLine" id="cb83-4" title="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb83-5" title="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic polynomial&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>) </a>
<a class="sourceLine" id="cb84-3" title="3">yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a  <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span> </a>
<a class="sourceLine" id="cb84-4" title="4"><span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><span class="math inline">\(R^{2}=1-\frac{SSE}{TSS}\)</span></li>
<li><span class="math inline">\(SSE=\sum_{i=1}^{n}(\hat y_{i}-y_{i})^{2}\)</span></li>
<li><span class="math inline">\(TSS=\sum_{i=1}^{n}(\bar y_{i}-y_{i})^{2}\)</span></li>
<li><span class="math inline">\(Adjust R^{2}=1-\frac{(1-R^2)(n-1)}{n-p-1}\)</span></li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) </a>
<a class="sourceLine" id="cb85-2" title="2">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="co"># for n-fold cross validation </span></a>
<a class="sourceLine" id="cb85-4" title="4"><span class="co"># fit models on leave-one-out samples </span></a>
<a class="sourceLine" id="cb85-5" title="5"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </a>
<a class="sourceLine" id="cb85-6" title="6">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb85-7" title="7">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb85-8" title="8">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb85-9" title="9">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb85-10" title="10">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb85-11" title="11"></a>
<a class="sourceLine" id="cb85-12" title="12">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb85-13" title="13">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb85-14" title="14">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb85-15" title="15"></a>
<a class="sourceLine" id="cb85-16" title="16">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb85-17" title="17">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb85-18" title="18">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb85-19" title="19">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb85-20" title="20"></a>
<a class="sourceLine" id="cb85-21" title="21">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb85-22" title="22">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb85-23" title="23">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb85-24" title="24">  } </a>
<a class="sourceLine" id="cb85-25" title="25">MSE &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">Linear=</span><span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="dt">Quadratic=</span><span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="dt">Exponential=</span><span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="dt">Cubic_ploy=</span><span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb85-26" title="26">TSS &lt;-<span class="st"> </span><span class="kw">var</span>(y)<span class="op">*</span>n</a>
<a class="sourceLine" id="cb85-27" title="27">SSE &lt;-<span class="st"> </span>MSE<span class="op">*</span>n</a>
<a class="sourceLine" id="cb85-28" title="28">R2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>SSE<span class="op">/</span>TSS</a>
<a class="sourceLine" id="cb85-29" title="29">p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb85-30" title="30">ADR2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>R2)<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>(n<span class="op">-</span>p<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb85-31" title="31"></a>
<a class="sourceLine" id="cb85-32" title="32">MSE &lt;-<span class="st"> </span><span class="kw">signif</span>(MSE,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb85-33" title="33">R2 &lt;-<span class="st"> </span><span class="kw">signif</span>(R2,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb85-34" title="34">ADR2 &lt;-<span class="st"> </span><span class="kw">signif</span>(ADR2,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb85-35" title="35"><span class="kw">rbind</span>(MSE, R2, ADR2)</a></code></pre></div>
<pre><code>##      Linear Quadratic Exponential Cubic_ploy
## MSE  19.600    17.900      18.400     18.200
## R2    0.478     0.524       0.508      0.515
## ADR2  0.468     0.504       0.498      0.485</code></pre>
<ul>
<li><p>Quadratic model is selected according to mininize average squared prediction error MSE.</p></li>
<li><p>Quadratic model is selected according to maximum <span class="math inline">\(R^2\)</span>.</p></li>
<li><p>Quadratic model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>.</p></li>
</ul>
</div>
</div>
<div id="hw-2019-11-22" class="section level1">
<h1>HW 2019-11-22</h1>
<div id="exercise-8.3" class="section level2">
<h2>Exercise 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co"># count5 statistic</span></a>
<a class="sourceLine" id="cb87-2" title="2">count5stat &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb87-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb87-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) </a>
<a class="sourceLine" id="cb87-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </a>
<a class="sourceLine" id="cb87-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X)) <span class="co"># return 1 (reject) or 0 (do not reject H0) </span></a>
<a class="sourceLine" id="cb87-7" title="7">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</a>
<a class="sourceLine" id="cb87-8" title="8">  }</a>
<a class="sourceLine" id="cb87-9" title="9"></a>
<a class="sourceLine" id="cb87-10" title="10"><span class="co"># generate samples with two different sample sizes</span></a>
<a class="sourceLine" id="cb87-11" title="11">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb87-12" title="12">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">25</span>,<span class="dv">1</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb87-13" title="13"></a>
<a class="sourceLine" id="cb87-14" title="14"></a>
<a class="sourceLine" id="cb87-15" title="15">R &lt;-<span class="st"> </span><span class="dv">999</span></a>
<a class="sourceLine" id="cb87-16" title="16">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb87-17" title="17">K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(x)<span class="op">+</span><span class="kw">length</span>(y))</a>
<a class="sourceLine" id="cb87-18" title="18">n&lt;-<span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb87-19" title="19"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb87-20" title="20">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb87-21" title="21">t0 &lt;-<span class="st"> </span><span class="kw">count5stat</span>(x,y)</a>
<a class="sourceLine" id="cb87-22" title="22"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){ </a>
<a class="sourceLine" id="cb87-23" title="23">  <span class="co"># permutation R times</span></a>
<a class="sourceLine" id="cb87-24" title="24">  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb87-25" title="25">  x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb87-26" title="26">  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb87-27" title="27">  reps[i] &lt;-<span class="st"> </span><span class="kw">count5stat</span>(x1,y1) </a>
<a class="sourceLine" id="cb87-28" title="28">} </a>
<a class="sourceLine" id="cb87-29" title="29">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0)) </a>
<a class="sourceLine" id="cb87-30" title="30"><span class="kw">print</span>(p)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="exercise-from-slide-p31" class="section level2">
<h2>Exercise from Slide P31</h2>
<ul>
<li>Power comparison (distance correlation test versus ball covariance test)
<ul>
<li>Model 1: <span class="math inline">\(Y = X/4 + e\)</span></li>
<li>Model 2: <span class="math inline">\(Y = X/4 × e\)</span></li>
<li><span class="math inline">\(X\sim N(0_{2}, I_{2}), e\sim N(0_{2}, I_{2})\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb89-3" title="3"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="kw">library</span>(MASS)</a></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){</a>
<a class="sourceLine" id="cb90-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb90-3" title="3">  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb90-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb90-5" title="5">  m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb90-6" title="6">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb90-7" title="7">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y))))) <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb90-8" title="8">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb90-9" title="9">    d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb90-10" title="10">    m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb90-11" title="11">    M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb90-12" title="12">    a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m)</a>
<a class="sourceLine" id="cb90-13" title="13">    b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb90-14" title="14">    b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb90-15" title="15">    }</a>
<a class="sourceLine" id="cb90-16" title="16">  A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</a>
<a class="sourceLine" id="cb90-17" title="17">  B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb90-18" title="18">  <span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb90-19" title="19">}</a>
<a class="sourceLine" id="cb90-20" title="20">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb90-21" title="21">  <span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb90-22" title="22">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb90-23" title="23">  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb90-24" title="24">  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb90-25" title="25">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb90-26" title="26">  y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb90-27" title="27">  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-28" title="28">}</a></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb91-2" title="2">I &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb91-3" title="3">m &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb91-5" title="5">R &lt;-<span class="st"> </span><span class="dv">99</span></a>
<a class="sourceLine" id="cb91-6" title="6"></a>
<a class="sourceLine" id="cb91-7" title="7">pow &lt;-<span class="st"> </span><span class="cf">function</span>(n,model){</a>
<a class="sourceLine" id="cb91-8" title="8">  p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb91-9" title="9">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb91-10" title="10">    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,mu,I)</a>
<a class="sourceLine" id="cb91-11" title="11">    e &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n,mu,I)</a>
<a class="sourceLine" id="cb91-12" title="12">    <span class="cf">if</span>(model<span class="op">==</span><span class="dv">1</span>) y &lt;-<span class="st"> </span>x<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e</a>
<a class="sourceLine" id="cb91-13" title="13">    <span class="cf">if</span>(model<span class="op">==</span><span class="dv">2</span>) y &lt;-<span class="st"> </span>x<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e</a>
<a class="sourceLine" id="cb91-14" title="14">    z&lt;-<span class="kw">cbind</span>(x,y)</a>
<a class="sourceLine" id="cb91-15" title="15">    boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb91-16" title="16">    tb &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0, boot.obj<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb91-17" title="17">    p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb<span class="op">&gt;=</span>tb[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb91-18" title="18">    p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(x,y,<span class="dt">R=</span>R,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">123</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb91-19" title="19">    }</a>
<a class="sourceLine" id="cb91-20" title="20">  alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb91-21" title="21">  pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb91-22" title="22">  <span class="kw">return</span>(pow2)</a>
<a class="sourceLine" id="cb91-23" title="23">}</a></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">N &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">75</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb92-2" title="2">power1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb92-3" title="3">power2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb92-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) {</a>
<a class="sourceLine" id="cb92-5" title="5">  power1[i,] &lt;-<span class="st"> </span><span class="kw">pow</span>(N[i],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb92-6" title="6">  power2[i,] &lt;-<span class="st"> </span><span class="kw">pow</span>(N[i],<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb92-7" title="7">}</a>
<a class="sourceLine" id="cb92-8" title="8"><span class="kw">plot</span>(N,power1[,<span class="dv">1</span>],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;Power Comparison : Y=X/4+e&quot;</span>)</a>
<a class="sourceLine" id="cb92-9" title="9"><span class="kw">lines</span>(N,power1[,<span class="dv">2</span>],<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb92-10" title="10"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Ball covariance&quot;</span>,<span class="st">&quot;Distance correlation&quot;</span>),</a>
<a class="sourceLine" id="cb92-11" title="11">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">1</span>)  </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">plot</span>(N,power2[,<span class="dv">1</span>],<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&quot;Power Comparison : Y=X/4*e&quot;</span>)</a>
<a class="sourceLine" id="cb93-2" title="2"><span class="kw">lines</span>(N,power2[,<span class="dv">2</span>],<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb93-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Ball covariance&quot;</span>,<span class="st">&quot;Distance correlation&quot;</span>),</a>
<a class="sourceLine" id="cb93-4" title="4">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="dt">lty=</span><span class="dv">1</span>,<span class="dt">lwd=</span><span class="dv">1</span>)  </a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA21BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kJA6kLY6kNtmAABmADpmOgBmOjpmOmZmZjpmZmZmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQkGaQkLaQtpCQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2kGa2tpC225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb////AAD/tmb/25D/27b//7b//9v///9UuWJZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANHklEQVR4nO2dDZucthHH2fNdspdrGqe7cfrq3cRpk+bIS+32sF23zZV74ft/omhmJBAsYkCgRdzO/3ns3WPFgH6MRi8IlBSiTiVzn0DsEkCMBBAjAcRIADESQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMBBAjAcRIADESQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMBBAjAcRIADESQIwEECMBxIgDlCWkT9/4HuHx3dWo/Y2ZfXJx67NjmiQb82Vnbb+7TM5uqs+7S/wLjrOGz2x1jcn6Akp0+sF6eKENbPz2N/IG9LClc1cg6gZU1tZoF7nlxEVvzZ+/O/vp90CsNyDP04Pja+341EFUgmhcY0JDv0IqvIIKI/ydlmfMA0LPu9eX4f2XSfLsT7dg4eLWeG0O/z/+oLzs+S3usvrbi+TsjTm782/V/ntNuDSgLuz6/VWyelm8vUzOwXaanP1D/XqOO74Hx/v0ujL3mjzorSqvq8/IdmkL0nyvjn9eErD9jUDk6MOQ/7JAQOH6SRc0lWin0yJOdfzPXsOGnoDgFK5Lf1LHzuFvlUk4qsrZDXxVOr8xiej81AF10f7q+X8L24DeIUkgQmGi1Dr3vPqqzf2CWdb7o83KVunnpY/UCiQUrl/2OtLYKbPKsx+22ub5C/SoLLmCJOos+wH6sIVPKsYZUFFfd9ofMayl4DLq7w0e9uJN8Z+CjquLdnWq2gDBfadO8CVtAEDKxjtt8uPbujnMMpi7hSSbmi300zf6+yEg+OE3BKIOCC8Spbu7hE912b/HIK3+/DdsUefEArJiUEq04AOpZHgxgZU61MbgzKxwQ3ksZRlQe5AfXRgSupbRaYoPP16ht2tzmGWV8Pz1oS2dRv1qX41KpuAcKC+dDmO0OpudrsXeflf8eIME+wJShsxlweKWqe9p8tF2dZ0RpDJZZkXDOiDbAPkW/W8AaS+HQ70ic2tTuGlfCvkYdxono8tDOyALxCE40wbYwX/rspo3p98TEMZFcwI5Bb3V37fJy32ygXidJ+2A6udsG3ACgh/hzM//+mHbBFTcU6Nh9V39ZDhAZa5bYpC2rj5yOIEaIMgWC4gcvigaF02dzW8vwX0+2pqQVO6ysmsTE6QV4t4eRBseDgGp+vCbKyzvgzyoHRC0kP5AQQhjtKklqlDWy4MqQLVij+bIdQjXutrFcud6NV+PQQeAyhiUm5iyOQAEX79OMDt2DPIBBG1s8NWNDkGHgHrFIAuQXXGg+63RBLWIVIvmfku/W4DqDcV6LXYIyNRimA6gruuA1DF/h+WMIrtVizUANdrdtXJjlCfaDLrgpjVpn1rMAmQ3PfBi7BAAGNTNGmq42AGx7Go8rxtoBYSiQNAapIsfmhHEtIOGAzJdEGhG3KZlhKgn7d0OMsLG65+NJd2OQ9v3rxQwbOLWAZnO6uuGgdYY9K9X2gbUYuffZlXxMVm2e77VyfgASnXNDxfj822Zy0bS+4iGO9L6tYhEAoiRAGIkgBhFBChOCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAojRxICSxWguQNOaCycBxEgAMToyoOFF+xj6f7vwt1PxIAcDi4RDTxdQfwadekqAJkJS1/IBTY6krkUDCoel0lIBHYMNaoGAjsYGtSxAx2WDWgygGdiglgBoLjaoQIDgESJ8lsv1FoXe5mZkgwoDKMOnKtfwZJbjTRx9zc1LpwgE6HEPT3fSY3qON3n0NDc7nzCAHrbwog56dtvxYE4/c/PziduDIuATOgYhKl9zMfCJuRaLgk/E7aA4+MQLKBI+wQFlnrVYLHyiHbQ/VUB9zUXDJ1JA8fAJBci8dMT5gHunuYj4hGoompfI5K7XRnaZi4lPwK4GyaOrEQWfsh4J11klDe+szs2nUclG50Ez8mltf4SKQdqFBsegWfh0Nc2GA3J20G2Z94s6X3wbCSC+0TockBVgRshx3CPe7+o5CcejiLni7iDNCCjQ1EPLgxKmEeh/3OA32odP3YqrqxEUkN+0tqgAhePjP+nPBxC+ujgd9+r5YwIaNSPSJ0ivrjN4pfUoQm3HDcJn7HxRv3YQtI9dY4X+x50c0BSzaf3aQQBoXG3fctyJ+Uw01djfg1K/5SHcx50S0HQTsb1jUDZu+YvD407GZ9pp6p61mO8CLB2D9tMAmnwOfzztoAkAhXjCIRpAY/mEev7Dqy+2DnDcUYACPhzj4UHWS9enO+4YPkEfHfIuYg/bSdtBI542CYnHFxA40aQe5M0n+INnHoBglYPRY2YTAQqNxy9ITzKiuBgNBtSxuNJTlGeQznottHd3OddqfNMpSC1WDlsnE0SrmeUBKOWznpuFEk/Rg8xSN5162MJgyGkC6qlUUTxVQLj2FutFWbI5UUC5XsaRy/zd5bOTBGQmL7gmtlTSa7YuW/6TFya5RR+/QnoQplo6xoAxqNXK0B7O7ApXiz0RzTUmvRgFAsROJHeJ+jE191S1wqBZbdNMgTPyvi/WGaL5ieQu0f3arLa+6EBA08rvzmrRyENDPaYBu0SAalNHlgbocU8n23FvvsdEcpcMIFqrGEedbECwpuy6oNV/N7qvBxfMJP3im+Tsn/Wd/7KlsSuza5YkQ9zao6H4hV543Z31Hh7kei2SLmJr+LomP7UA0Z8bxWenPteP+zXtUiXFpX139s6w/rD+B7tm2InuT8jfg7oKDz+R3CU92AT5hAsBPlIBMiWPLgBMolAXSW20km7I/epb1BezK30O8GuvhiJ5bFdYYCeSu0QelOtBb1wMvAJkRgfoE7O90yGxTGr1hewtZldKPWCYYcQ04CDjqTqypbh2c3L2c82D7j6h0k35g42qJKW0FLhJqgE1t5hdc33mAQGFlQakyg5SqBexAw9SZQVCsp2UAB1sqXvQAEUKSH1gnMiTzhiktvxRJbOTEqCDLVUMGthgiBMQZI2uvwryjVoMqi5di0F6WmW9Slp5UH2L2RXbb2l/P4oOUNXVyOBTZcXdDiqqGqNMWsWgwy1lO2hA7IwNUHQSQIwEECMBxEgAMRJAjI4M6DQG7UMqrbpKtUZvPuWIWdNyV/M6OkDYkr67XNc3TzukaFvjLMcJ6KBPKYCMNCDoNeGp4z24HfyPbx7sM4za6I7QMCz8d2PS0ZgjGkPL/0NIJn1pfVi+p35WwxGuzUh3Cg996mEL1d8aMIzaGJY1w7Bg16TTI0lmQFe/ObRMry0PzPdxPQgGhMphi2LIMOrBkIgeht1Y6aD7aw3o4r96+mrIMXJAZqpo/2HU1mFZ7SMmnbZWGit9tZ5+WL6PDEgXsUK/zrP/MOrBsKwFyKTD8SHLWAWoln5YvmcK0riNhnX6DaOyHlRU+94dADqaB/nfm6+q+fIk9WXtN4zaEoNMhm2DNWONGHQEQGPvzWOVVN7T0ZGz5zBqc1jWyrBJpz1IG9s0a7HwgMbcm290NXI9AJsm8KB1r2HUZjvIyrBOp2MQGgPLjXZQeECWzy9+JmNsHhSdQsUg33vz0SlQLeZ9bz46xdYOik4CiFFoQKc4kXzU4WRM+qlJADGKrbManWLrrEanuboayWIUAtCIzmqPw/BJJjEyNOoeqbN6GoBGdFZPBJB/Z/VUAHlLAI0/jAAanUQAHcOIAJogyYjkpycBxEgAMRJAjAQQIwHESAAxEkCMBBAjAcRIADESQIwEEKPAgPBOo37Qu+P9aOaxekcSePJi3W0EpinuupP4KSygxz08IAGZg3mtzvdH5DjI7UyS41MZnUZgois+a995HB+FBUTTuLOzG7pjBE+atAhXfiucSeiHTiP6jUNrtxFvHSMGqStakmr7Pbv4WgFyJjFPIbhTVIA6j+OlYwBKz24ok+33Y9VvEIOcSeBVMBjIOoyYItZ1HD8dARDcZaSw0BocoFQAIGeSDCaT4CR7txETm7uS+Ck8oNzEaMeJm1Xf3IBW2is6jMCbm+BBhwUCorvUbtfHXzqLGEUUFV06jJjQs7wiltnrBLQFz0xPR9k5k1B2VdbdRkrHWVyQNtMdmOo37armadZN3lXN6zcvMs0JL4VuB5lZIN0NuLSzoZgZfG4jJgYtraGoyw+ccMZ3NZxJyhdTuY2kfBI/SWeVkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYCSBGAoiRAGIkgBgJIEYCiJEAYiSAGAkgRgKIkQBiJIAYxQ3ocU8TWTqW7gyt2AHR/GgB5NDj/hlOGRNADj3u17Q2qwBqlwJECycIoHbha7f1LNiZFD8gM496JsUPCOZmCiCH9DMYGwHkEAG6++RKALWLAOHSAHOdwiIA0RpH8yhuQBFIADESQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMBBAjAcRIADESQIwEECMBxEgAMRJAjAQQIwHESAAxEkCMBBCjXwFqGRTa1MEbMgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>
<div id="hw-2019-11-29" class="section level1">
<h1>HW 2019-11-29</h1>
<div id="exercise-9.4" class="section level2">
<h2>Exercise 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<ul>
<li>Recall : The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}, x\sim\mathbb{R}\)</span>.</li>
</ul>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">lap.f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb94-2" title="2">  <span class="co"># prop density function of Laplace distribution</span></a>
<a class="sourceLine" id="cb94-3" title="3">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb94-4" title="4">}</a></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">random.walk.Me &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){ </a>
<a class="sourceLine" id="cb95-2" title="2">  <span class="co"># function to generate a random walk metropolis chain</span></a>
<a class="sourceLine" id="cb95-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </a>
<a class="sourceLine" id="cb95-4" title="4">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0 </a>
<a class="sourceLine" id="cb95-5" title="5">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N) </a>
<a class="sourceLine" id="cb95-6" title="6">  k &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb95-7" title="7">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){ </a>
<a class="sourceLine" id="cb95-8" title="8">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) </a>
<a class="sourceLine" id="cb95-9" title="9">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap.f</span>(y)<span class="op">/</span><span class="kw">lap.f</span>(x[i<span class="dv">-1</span>]))){</a>
<a class="sourceLine" id="cb95-10" title="10">      x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb95-11" title="11">    }<span class="cf">else</span>{ </a>
<a class="sourceLine" id="cb95-12" title="12">      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>] </a>
<a class="sourceLine" id="cb95-13" title="13">      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span> } </a>
<a class="sourceLine" id="cb95-14" title="14">    } </a>
<a class="sourceLine" id="cb95-15" title="15">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k)) </a>
<a class="sourceLine" id="cb95-16" title="16">} </a>
<a class="sourceLine" id="cb95-17" title="17"></a>
<a class="sourceLine" id="cb95-18" title="18">N &lt;-<span class="st"> </span><span class="dv">2000</span> </a>
<a class="sourceLine" id="cb95-19" title="19">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb95-20" title="20">x0 &lt;-<span class="st"> </span><span class="dv">25</span> </a>
<a class="sourceLine" id="cb95-21" title="21">rw1 &lt;-<span class="st"> </span><span class="kw">random.walk.Me</span>(sigma[<span class="dv">1</span>], x0, N) </a>
<a class="sourceLine" id="cb95-22" title="22">rw2 &lt;-<span class="st"> </span><span class="kw">random.walk.Me</span>(sigma[<span class="dv">2</span>], x0, N) </a>
<a class="sourceLine" id="cb95-23" title="23">rw3 &lt;-<span class="st"> </span><span class="kw">random.walk.Me</span>(sigma[<span class="dv">3</span>], x0, N) </a>
<a class="sourceLine" id="cb95-24" title="24">rw4 &lt;-<span class="st"> </span><span class="kw">random.walk.Me</span>(sigma[<span class="dv">4</span>], x0, N)</a></code></pre></div>
<ul>
<li><p>Compare the chains generated when different variances are used for the proposal distribution.</p></li>
<li><p>The inverse of the cumulative distribution function of the standard Laplace distribution is <span class="math display">\[F^{-1}(p)=-sign(p-0.5)ln(1-2|p-0.5|).\]</span> So we use <span class="math inline">\(2.5\%\)</span> quantile and <span class="math inline">\(97.5\%\)</span> quantile as reference lines.</p></li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">inverse.F &lt;-<span class="st"> </span><span class="cf">function</span>(p){</a>
<a class="sourceLine" id="cb96-2" title="2">  <span class="cf">if</span>(p<span class="op">&gt;=</span><span class="fl">0.5</span>){</a>
<a class="sourceLine" id="cb96-3" title="3">     perc &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">abs</span>(p<span class="fl">-0.5</span>))</a>
<a class="sourceLine" id="cb96-4" title="4">  }<span class="cf">else</span>{perc &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="dv">1-2</span><span class="op">*</span><span class="kw">abs</span>(p<span class="fl">-0.5</span>))}</a>
<a class="sourceLine" id="cb96-5" title="5">  <span class="kw">return</span>(perc) </a>
<a class="sourceLine" id="cb96-6" title="6">}</a>
<a class="sourceLine" id="cb96-7" title="7">perc1 &lt;-<span class="st"> </span><span class="kw">inverse.F</span>(<span class="fl">0.025</span>)</a>
<a class="sourceLine" id="cb96-8" title="8">perc2 &lt;-<span class="st"> </span><span class="kw">inverse.F</span>(<span class="fl">0.975</span>)</a></code></pre></div>
<p>Compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">rw.k &lt;-<span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb97-2" title="2">rate.acceptance &lt;-<span class="st"> </span>(N<span class="op">-</span>rw.k)<span class="op">/</span>N</a>
<a class="sourceLine" id="cb97-3" title="3"><span class="kw">rbind</span>(sigma,rate.acceptance)</a></code></pre></div>
<pre><code>##                   [,1]   [,2]   [,3]    [,4]
## sigma           0.0500 0.5000 2.0000 16.0000
## rate.acceptance 0.9785 0.8255 0.5395  0.1035</code></pre>
<p>We will find that as the variance becomes larger, the Markov chain converges quickly, but the acceptance rate will also drop quickly.</p>
</div>
</div>
<div id="hw-2019-12-06" class="section level1">
<h1>HW 2019-12-06</h1>
<div id="exercise-11.1" class="section level2">
<h2>Exercise 11.1</h2>
<blockquote>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(expx) = exp(logx)=x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</blockquote>
<ul>
<li>Show by example that this property does not hold exactly in computer arithmetic.</li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>,<span class="fl">0.1</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb99-2" title="2">le &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb99-3" title="3">el &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb99-4" title="4"><span class="kw">sum</span>(x<span class="op">==</span>le) <span class="co"># number of x=log(exp(x))</span></a></code></pre></div>
<pre><code>## [1] 998</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">sum</span>(x<span class="op">==</span>el) <span class="co"># number of x=exp(log(x))</span></a></code></pre></div>
<pre><code>## [1] 293</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">sum</span>(le<span class="op">==</span>el)<span class="co"># number of log(exp(x))=exp(log(x))</span></a></code></pre></div>
<pre><code>## [1] 291</code></pre>
<ul>
<li>The identity does hold with near equality.</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">eq &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb105-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb105-3" title="3">  eq[<span class="dv">1</span>] &lt;-<span class="st"> </span>eq[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">all.equal</span>(x[i],le[i])</a>
<a class="sourceLine" id="cb105-4" title="4">  eq[<span class="dv">2</span>] &lt;-<span class="st"> </span>eq[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">all.equal</span>(x[i],el[i])</a>
<a class="sourceLine" id="cb105-5" title="5">  eq[<span class="dv">3</span>] &lt;-<span class="st"> </span>eq[<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span><span class="kw">all.equal</span>(el[i],le[i])</a>
<a class="sourceLine" id="cb105-6" title="6">}</a>
<a class="sourceLine" id="cb105-7" title="7"><span class="kw">print</span>(eq)</a></code></pre></div>
<pre><code>## [1] 1000 1000 1000</code></pre>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<blockquote>
<p>Write a function to solve the equation <span class="math display">\[\frac{2\Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}\Gamma\left(\frac{k-1}{2}\right)}\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k/2}du =\frac{2\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}\Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1)/2}du  
\]</span> for a, where <span class="math inline">\(c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\)</span>. Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</blockquote>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">cupper &lt;-<span class="st"> </span><span class="cf">function</span>(k,a){</a>
<a class="sourceLine" id="cb107-2" title="2">  <span class="kw">return</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb107-3" title="3">}</a>
<a class="sourceLine" id="cb107-4" title="4">f1 &lt;-<span class="st"> </span><span class="cf">function</span>(u){</a>
<a class="sourceLine" id="cb107-5" title="5">  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb107-6" title="6">}</a>
<a class="sourceLine" id="cb107-7" title="7">f2 &lt;-<span class="st"> </span><span class="cf">function</span>(u){</a>
<a class="sourceLine" id="cb107-8" title="8">  (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb107-9" title="9">}</a>
<a class="sourceLine" id="cb107-10" title="10">sol1 &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb107-11" title="11">  <span class="co"># the toot of sol1 is A(k)</span></a>
<a class="sourceLine" id="cb107-12" title="12">  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">cupper</span>(k<span class="dv">-1</span>,a))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">cupper</span>(k,a))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb107-13" title="13">}   </a>
<a class="sourceLine" id="cb107-14" title="14"></a>
<a class="sourceLine" id="cb107-15" title="15">kt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb107-16" title="16">n &lt;-<span class="st"> </span><span class="kw">length</span>(kt)</a>
<a class="sourceLine" id="cb107-17" title="17">A1 &lt;-<span class="st"> </span>A2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb107-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb107-19" title="19">  k &lt;-<span class="st"> </span>kt[i]</a>
<a class="sourceLine" id="cb107-20" title="20">  A1[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(sol1,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb107-21" title="21">}</a>
<a class="sourceLine" id="cb107-22" title="22"></a>
<a class="sourceLine" id="cb107-23" title="23"><span class="co">## Exercise 11.4</span></a>
<a class="sourceLine" id="cb107-24" title="24">sol2 &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb107-25" title="25">   <span class="co"># the toot of sol2 is A(k)</span></a>
<a class="sourceLine" id="cb107-26" title="26">   <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">cupper</span>(k<span class="dv">-1</span>,a),k<span class="dv">-1</span>)<span class="op">-</span><span class="dv">1</span><span class="op">+</span><span class="kw">pt</span>(<span class="kw">cupper</span>(k,a),k)</a>
<a class="sourceLine" id="cb107-27" title="27">  }</a>
<a class="sourceLine" id="cb107-28" title="28"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb107-29" title="29">   k &lt;-<span class="st"> </span>kt[i]</a>
<a class="sourceLine" id="cb107-30" title="30">   A2[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(sol2,<span class="kw">c</span>(<span class="fl">1e-5</span>,<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">1e-5</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb107-31" title="31"> }</a>
<a class="sourceLine" id="cb107-32" title="32"></a>
<a class="sourceLine" id="cb107-33" title="33"><span class="kw">cbind</span>(<span class="dt">df.t=</span>kt,<span class="dt">root.ex11.5=</span>A1,<span class="dt">root.ex11.4=</span>A2)</a></code></pre></div>
<pre><code>##       df.t root.ex11.5 root.ex11.4
##  [1,]    4    1.492105    1.492103
##  [2,]    5    1.533565    1.533549
##  [3,]    6    1.562774    1.562768
##  [4,]    7    1.584429    1.584421
##  [5,]    8    1.601210    1.601182
##  [6,]    9    1.614520    1.614523
##  [7,]   10    1.625383    1.625387
##  [8,]   11    1.634421    1.634409
##  [9,]   12    1.642056    1.642025
## [10,]   13    1.648526    1.648540
## [11,]   14    1.654168    1.654177
## [12,]   15    1.659095    1.659098
## [13,]   16    1.663433    1.663451
## [14,]   17    1.667281    1.667288
## [15,]   18    1.670725    1.670736
## [16,]   19    1.673824    1.673841
## [17,]   20    1.676639    1.676588
## [18,]   21    1.679154    1.679139
## [19,]   22    1.681472    1.681461
## [20,]   23    1.683596    4.795822
## [21,]   24    1.685550    4.898969
## [22,]   25    1.687355    4.999990
## [23,]  100    1.720600    9.999990</code></pre>
<ul>
<li>Here we find that when the value of K is small, the results of the two methods are close, but when the value of K is large, especially when we take k = 100 here, the results will be very different. I think the reason for this phenomenon is the problem of calculation accuracy and the error caused by the approximation of our integral. These two reasons lead to a great difference in our A(k).</li>
</ul>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<blockquote>
<p>Let the three alleles be A, B, and O with allele frequencies p, q, and r. The 6 genotype frequencies under HWE and complete counts are as follows.</p>
</blockquote>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">AA</th>
<th align="center">BB</th>
<th align="center">OO</th>
<th align="center">AO</th>
<th align="center">BO</th>
<th align="center">AB</th>
<th align="center">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Frequency</td>
<td align="center"><span class="math inline">\(p^2\)</span></td>
<td align="center"><span class="math inline">\(q^2\)</span></td>
<td align="center"><span class="math inline">\(r^2\)</span></td>
<td align="center">2pr</td>
<td align="center">2qr</td>
<td align="center">2pq</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">Count</td>
<td align="center"><span class="math inline">\(n_{AA}\)</span></td>
<td align="center"><span class="math inline">\(n_{BB}\)</span></td>
<td align="center"><span class="math inline">\(n_{OO}\)</span></td>
<td align="center"><span class="math inline">\(n_{AO}\)</span></td>
<td align="center"><span class="math inline">\(n_{BO}\)</span></td>
<td align="center"><span class="math inline">\(n_{AB}\)</span></td>
<td align="center">n</td>
</tr>
</tbody>
</table>
<ul>
<li>Observed data:
<ul>
<li><span class="math inline">\(n_{A·}=n_{AA}+n_{AO}\)</span>=28(A-type),</li>
<li><span class="math inline">\(n_{B·}=n_{BB}+n_{BO}\)</span>=24(B-type),</li>
<li><span class="math inline">\(n_{OO}\)</span>=41(O-type),</li>
<li><span class="math inline">\(n_{AB}\)</span>=70(AB-type).</li>
</ul></li>
<li>Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</li>
<li>Show that the log-maximum likelihood values in M-steps are increasing via line plot.</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="kw">set.seed</span>(<span class="dv">999</span>)</a>
<a class="sourceLine" id="cb109-2" title="2"><span class="kw">library</span>(stats4)</a>
<a class="sourceLine" id="cb109-3" title="3"></a>
<a class="sourceLine" id="cb109-4" title="4">dll &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb109-5" title="5">  <span class="co"># root of dll is the p and q that maximum loglikeli</span></a>
<a class="sourceLine" id="cb109-6" title="6">  t &lt;-<span class="st"> </span><span class="kw">c</span>(n.ob[<span class="dv">5</span>],n.ob[<span class="dv">6</span>],n.ob[<span class="dv">3</span>],n.ob[<span class="dv">1</span>]<span class="op">-</span>n.ob[<span class="dv">5</span>],n.ob[<span class="dv">2</span>]<span class="op">-</span>n.ob[<span class="dv">6</span>],n.ob[<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb109-7" title="7">  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb109-8" title="8">  f1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>t[<span class="dv">1</span>]<span class="op">/</span>x[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>t[<span class="dv">3</span>]<span class="op">/</span>r<span class="op">+</span>t[<span class="dv">6</span>]<span class="op">/</span>x[<span class="dv">1</span>]<span class="op">+</span>t[<span class="dv">4</span>]<span class="op">/</span>x[<span class="dv">1</span>]<span class="op">-</span>t[<span class="dv">4</span>]<span class="op">/</span>r<span class="op">-</span>t[<span class="dv">5</span>]<span class="op">/</span>r</a>
<a class="sourceLine" id="cb109-9" title="9">  f2 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>t[<span class="dv">2</span>]<span class="op">/</span>x[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>t[<span class="dv">3</span>]<span class="op">/</span>r<span class="op">+</span>t[<span class="dv">6</span>]<span class="op">/</span>x[<span class="dv">2</span>]<span class="op">-</span>t[<span class="dv">4</span>]<span class="op">/</span>r<span class="op">+</span>t[<span class="dv">5</span>]<span class="op">/</span>x[<span class="dv">2</span>]<span class="op">-</span>t[<span class="dv">5</span>]<span class="op">/</span>r</a>
<a class="sourceLine" id="cb109-10" title="10">  <span class="kw">c</span>(<span class="dt">F1=</span>f1,<span class="dt">F2=</span>f2)</a>
<a class="sourceLine" id="cb109-11" title="11">}</a>
<a class="sourceLine" id="cb109-12" title="12"></a>
<a class="sourceLine" id="cb109-13" title="13">loglikeli &lt;-<span class="st"> </span><span class="cf">function</span>(p){</a>
<a class="sourceLine" id="cb109-14" title="14">  <span class="co"># loglikelihood function</span></a>
<a class="sourceLine" id="cb109-15" title="15">  <span class="kw">return</span>(<span class="dv">2</span><span class="op">*</span>n.ob[<span class="dv">5</span>]<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n.ob[<span class="dv">6</span>]<span class="op">*</span><span class="kw">log</span>(p[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>n.ob[<span class="dv">3</span>]<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>])<span class="op">+</span>(n.ob[<span class="dv">1</span>]<span class="op">-</span>n.ob[<span class="dv">5</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]))<span class="op">+</span>(n.ob[<span class="dv">2</span>]<span class="op">-</span>n.ob[<span class="dv">6</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]))<span class="op">+</span>n.ob[<span class="dv">4</span>]<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p[<span class="dv">1</span>]<span class="op">*</span>p[<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb109-16" title="16">}</a>
<a class="sourceLine" id="cb109-17" title="17"></a>
<a class="sourceLine" id="cb109-18" title="18">N &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb109-19" title="19"></a>
<a class="sourceLine" id="cb109-20" title="20">theta &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb109-21" title="21">ll &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb109-22" title="22">n.ob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">41</span>,<span class="dv">70</span>,<span class="ot">NaN</span>,<span class="ot">NaN</span>)</a>
<a class="sourceLine" id="cb109-23" title="23">n.ob[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n.ob[<span class="dv">1</span>],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb109-24" title="24">n.ob[<span class="dv">6</span>] &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n.ob[<span class="dv">2</span>],<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb109-25" title="25">n &lt;-<span class="st"> </span><span class="kw">sum</span>(n.ob[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a>
<a class="sourceLine" id="cb109-26" title="26"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb109-27" title="27"></a>
<a class="sourceLine" id="cb109-28" title="28"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb109-29" title="29">  theta[i,] &lt;-<span class="st"> </span><span class="kw">multiroot</span>(dll,<span class="dt">start=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb109-30" title="30">  ll[i] &lt;-<span class="st"> </span><span class="kw">loglikeli</span>(theta[i,])</a>
<a class="sourceLine" id="cb109-31" title="31">  w &lt;-<span class="st"> </span><span class="kw">c</span>(theta[i,],<span class="dv">1</span><span class="op">-</span><span class="kw">sum</span>(theta[i,]))</a>
<a class="sourceLine" id="cb109-32" title="32">  o &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb109-33" title="33">  o[<span class="dv">1</span>] &lt;-<span class="st"> </span>n<span class="op">*</span>w[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb109-34" title="34">  o[<span class="dv">2</span>] &lt;-<span class="st"> </span>n<span class="op">*</span>w[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb109-35" title="35">  o[<span class="dv">3</span>] &lt;-<span class="st"> </span>n<span class="op">*</span>w[<span class="dv">3</span>]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb109-36" title="36">  o[<span class="dv">4</span>] &lt;-<span class="st"> </span>n<span class="op">*</span><span class="dv">2</span><span class="op">*</span>w[<span class="dv">1</span>]<span class="op">*</span>w[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb109-37" title="37">  o[<span class="dv">5</span>] &lt;-<span class="st"> </span>n<span class="op">*</span><span class="dv">2</span><span class="op">*</span>w[<span class="dv">2</span>]<span class="op">*</span>w[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb109-38" title="38">  o[<span class="dv">6</span>] &lt;-<span class="st"> </span>n<span class="op">*</span><span class="dv">2</span><span class="op">*</span>w[<span class="dv">1</span>]<span class="op">*</span>w[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb109-39" title="39">  n.ob &lt;-<span class="st"> </span><span class="kw">c</span>(o[<span class="dv">1</span>]<span class="op">+</span>o[<span class="dv">4</span>],o[<span class="dv">2</span>]<span class="op">+</span>o[<span class="dv">5</span>],o[<span class="dv">3</span>],o[<span class="dv">6</span>],o[<span class="dv">1</span>],o[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb109-40" title="40">}</a>
<a class="sourceLine" id="cb109-41" title="41"></a>
<a class="sourceLine" id="cb109-42" title="42"><span class="kw">print</span>(theta[<span class="dv">9990</span><span class="op">:</span><span class="dv">10000</span>,])</a></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.3834356 0.3006135
##  [2,] 0.3834356 0.3006135
##  [3,] 0.3834356 0.3006135
##  [4,] 0.3834356 0.3006135
##  [5,] 0.3834356 0.3006135
##  [6,] 0.3834356 0.3006135
##  [7,] 0.3834356 0.3006135
##  [8,] 0.3834356 0.3006135
##  [9,] 0.3834356 0.3006135
## [10,] 0.3834356 0.3006135
## [11,] 0.3834356 0.3006135</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb111-2" title="2"><span class="kw">plot</span>(index,<span class="kw">exp</span>(ll[index]),<span class="dt">ylab=</span><span class="st">&quot;max-likelihood&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">index &lt;-<span class="st"> </span>(N<span class="dv">-1000</span>)<span class="op">:</span>N</a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw">plot</span>(index,<span class="kw">exp</span>(ll[index]),<span class="dt">ylab=</span><span class="st">&quot;max-likelihood&quot;</span>,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>Both pictures Show that the log-maximum likelihood values in M-steps are increasing.</li>
<li>We can also find that the convergence rate of EM algorithm is very fast in this problem.</li>
</ul>
</div>
</div>
<div id="hw-2019-12-13" class="section level1">
<h1>HW 2019-12-13</h1>
<div id="exercise-3-from-page-204" class="section level2">
<h2>Exercise 3 from page 204</h2>
<ul>
<li>Use both for loops and lapply() to ﬁt linear models to the mtcars using the formulas stored in this list:</li>
<li>formulas &lt;- list(mpg ~ disp, mpg ~ I(1/disp), mpg ~ disp+wt,mpg ~ I(1/disp)+wt)</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)</a>
<a class="sourceLine" id="cb113-2" title="2">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(mpg<span class="op">~</span>disp, mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp), mpg<span class="op">~</span>disp<span class="op">+</span>wt,mpg<span class="op">~</span><span class="kw">I</span>(<span class="dv">1</span><span class="op">/</span>disp)<span class="op">+</span>wt)</a>
<a class="sourceLine" id="cb113-3" title="3">lm.loop &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb113-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb113-5" title="5">  lm.loop[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]],<span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb113-6" title="6">}</a>
<a class="sourceLine" id="cb113-7" title="7">lm.lapply &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm,<span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb113-8" title="8">lm.loop</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">lm.lapply</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="exercise-4-from-page-204" class="section level2">
<h2>Exercise 4 from page 204</h2>
<ul>
<li>Fit the model mpg~disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?
<ul>
<li>bootstraps &lt;- lapply(1:10, function(i) {
<ul>
<li>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</li>
<li>mtcars[rows, ] })</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">boot.sample &lt;-<span class="st"> </span><span class="cf">function</span>(i){</a>
<a class="sourceLine" id="cb117-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb117-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb117-4" title="4">}</a>
<a class="sourceLine" id="cb117-5" title="5"></a>
<a class="sourceLine" id="cb117-6" title="6">lm.loop2 &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb117-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb117-8" title="8">  lm.loop2[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>disp,<span class="dt">data =</span> <span class="kw">boot.sample</span>(i))</a>
<a class="sourceLine" id="cb117-9" title="9">}</a>
<a class="sourceLine" id="cb117-10" title="10"></a>
<a class="sourceLine" id="cb117-11" title="11">lm.lapply2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, boot.sample),lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb117-12" title="12"></a>
<a class="sourceLine" id="cb117-13" title="13">lm.loop2</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    29.04442     -0.03932  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    29.13662     -0.03822  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##     30.8133      -0.0447  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    29.41507     -0.04147  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    27.44368     -0.03293  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    30.65598     -0.04403  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    31.00326     -0.04438  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##     29.8620      -0.0418  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    29.61250     -0.03958  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = boot.sample(i))
## 
## Coefficients:
## (Intercept)         disp  
##    29.35880     -0.04081</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">lm.lapply2</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.25541     -0.03913  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59082     -0.04192  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.54548     -0.03809  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.18663     -0.04577  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    32.51930     -0.05509  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.87662     -0.04475  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.57807     -0.04142  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.38511     -0.03664  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     28.8390      -0.0378  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.91905     -0.03654</code></pre>
</div>
<div id="exercise-5-from-page-204" class="section level2">
<h2>Exercise 5 from page 204</h2>
<ul>
<li>For each model in the previous two exercises,extract <span class="math inline">\(R^2\)</span> using the function below.</li>
<li>rsq &lt;- function(mod) summary(mod)$r.squared</li>
</ul>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb121-2" title="2"></a>
<a class="sourceLine" id="cb121-3" title="3">r2.ex3.loop &lt;-<span class="st"> </span><span class="kw">lapply</span>(lm.loop, rsq)</a>
<a class="sourceLine" id="cb121-4" title="4">r2.ex3.lapply &lt;-<span class="st"> </span><span class="kw">lapply</span>(lm.lapply,rsq)</a>
<a class="sourceLine" id="cb121-5" title="5"></a>
<a class="sourceLine" id="cb121-6" title="6">r2.ex4.loop &lt;-<span class="st"> </span><span class="kw">lapply</span>(lm.loop2, rsq)</a>
<a class="sourceLine" id="cb121-7" title="7">r2.ex4.lapply &lt;-<span class="st"> </span><span class="kw">lapply</span>(lm.lapply2, rsq)</a>
<a class="sourceLine" id="cb121-8" title="8"></a>
<a class="sourceLine" id="cb121-9" title="9">r2.ex3 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">model=</span><span class="kw">as.character</span>(formulas),r2.ex3.loop,r2.ex3.lapply)</a>
<a class="sourceLine" id="cb121-10" title="10">r2.ex4 &lt;-<span class="st"> </span><span class="kw">cbind</span>(r2.ex4.loop,r2.ex4.lapply)</a>
<a class="sourceLine" id="cb121-11" title="11"></a>
<a class="sourceLine" id="cb121-12" title="12">r2.ex3</a></code></pre></div>
<pre><code>##      model                  r2.ex3.loop r2.ex3.lapply
## [1,] &quot;mpg ~ disp&quot;           0.7183433   0.7183433    
## [2,] &quot;mpg ~ I(1/disp)&quot;      0.8596865   0.8596865    
## [3,] &quot;mpg ~ disp + wt&quot;      0.7809306   0.7809306    
## [4,] &quot;mpg ~ I(1/disp) + wt&quot; 0.8838038   0.8838038</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">r2.ex4</a></code></pre></div>
<pre><code>##       r2.ex4.loop r2.ex4.lapply
##  [1,] 0.7283588   0.7137732    
##  [2,] 0.7027162   0.7332487    
##  [3,] 0.7548916   0.6899542    
##  [4,] 0.7953467   0.7376026    
##  [5,] 0.4922375   0.7626674    
##  [6,] 0.7262154   0.7669397    
##  [7,] 0.6396368   0.7868589    
##  [8,] 0.705891    0.7602861    
##  [9,] 0.716635    0.6928586    
## [10,] 0.7115339   0.6353946</code></pre>
</div>
<div id="exercise-3-from-page-214" class="section level2">
<h2>Exercise 3 from page 214</h2>
<ul>
<li>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</li>
<li>trials &lt;- replicate(100,t.test(rpois(10,10),rpois(7,10)),simplify = FALSE)</li>
<li>Extra challenge: get rid of the anonymous function by using [[ directly.</li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb125-2" title="2">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="kw">rpois</span>(<span class="dv">7</span>,<span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb125-3" title="3"></a>
<a class="sourceLine" id="cb125-4" title="4"><span class="co"># Use sapply() and an anonymous function to extract the p-value from every trial.</span></a>
<a class="sourceLine" id="cb125-5" title="5">pv1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a>
<a class="sourceLine" id="cb125-6" title="6"><span class="co"># Extra challenge: get rid of the anonymous function by using [[ directly.</span></a>
<a class="sourceLine" id="cb125-7" title="7">pv2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb125-8" title="8"></a>
<a class="sourceLine" id="cb125-9" title="9"><span class="kw">cbind</span>(pv1,pv2)</a></code></pre></div>
<pre><code>##                 pv1          pv2
##   [1,] 9.813226e-01 9.813226e-01
##   [2,] 1.619096e-05 1.619096e-05
##   [3,] 6.242135e-01 6.242135e-01
##   [4,] 6.693526e-01 6.693526e-01
##   [5,] 5.677105e-01 5.677105e-01
##   [6,] 6.610740e-01 6.610740e-01
##   [7,] 5.951636e-01 5.951636e-01
##   [8,] 5.005347e-01 5.005347e-01
##   [9,] 4.763110e-01 4.763110e-01
##  [10,] 3.429965e-01 3.429965e-01
##  [11,] 8.155394e-01 8.155394e-01
##  [12,] 7.197238e-01 7.197238e-01
##  [13,] 1.244336e-01 1.244336e-01
##  [14,] 2.229164e-01 2.229164e-01
##  [15,] 1.113099e-02 1.113099e-02
##  [16,] 4.625765e-01 4.625765e-01
##  [17,] 6.515865e-01 6.515865e-01
##  [18,] 1.658793e-01 1.658793e-01
##  [19,] 9.342672e-01 9.342672e-01
##  [20,] 8.011934e-01 8.011934e-01
##  [21,] 4.627657e-01 4.627657e-01
##  [22,] 5.927934e-01 5.927934e-01
##  [23,] 2.929669e-01 2.929669e-01
##  [24,] 5.737967e-01 5.737967e-01
##  [25,] 3.451537e-02 3.451537e-02
##  [26,] 2.739138e-01 2.739138e-01
##  [27,] 2.656151e-01 2.656151e-01
##  [28,] 8.196695e-01 8.196695e-01
##  [29,] 6.647355e-01 6.647355e-01
##  [30,] 8.056529e-01 8.056529e-01
##  [31,] 5.060850e-01 5.060850e-01
##  [32,] 7.106543e-01 7.106543e-01
##  [33,] 2.321066e-01 2.321066e-01
##  [34,] 1.106223e-01 1.106223e-01
##  [35,] 5.459279e-01 5.459279e-01
##  [36,] 1.865470e-02 1.865470e-02
##  [37,] 2.433776e-01 2.433776e-01
##  [38,] 2.688851e-01 2.688851e-01
##  [39,] 9.819256e-01 9.819256e-01
##  [40,] 4.940184e-01 4.940184e-01
##  [41,] 3.268275e-01 3.268275e-01
##  [42,] 8.000439e-01 8.000439e-01
##  [43,] 9.822499e-01 9.822499e-01
##  [44,] 1.936454e-01 1.936454e-01
##  [45,] 7.390101e-01 7.390101e-01
##  [46,] 3.888930e-02 3.888930e-02
##  [47,] 4.350424e-01 4.350424e-01
##  [48,] 7.434339e-02 7.434339e-02
##  [49,] 5.787441e-01 5.787441e-01
##  [50,] 4.864951e-01 4.864951e-01
##  [51,] 1.476288e-01 1.476288e-01
##  [52,] 5.524909e-01 5.524909e-01
##  [53,] 7.129280e-01 7.129280e-01
##  [54,] 8.683479e-03 8.683479e-03
##  [55,] 9.053256e-02 9.053256e-02
##  [56,] 4.415463e-01 4.415463e-01
##  [57,] 4.955063e-01 4.955063e-01
##  [58,] 1.745328e-01 1.745328e-01
##  [59,] 6.615399e-01 6.615399e-01
##  [60,] 4.479199e-01 4.479199e-01
##  [61,] 2.885849e-01 2.885849e-01
##  [62,] 3.028567e-02 3.028567e-02
##  [63,] 1.018907e-01 1.018907e-01
##  [64,] 1.811861e-02 1.811861e-02
##  [65,] 6.376441e-01 6.376441e-01
##  [66,] 1.408742e-02 1.408742e-02
##  [67,] 9.008128e-02 9.008128e-02
##  [68,] 4.515933e-01 4.515933e-01
##  [69,] 8.703291e-01 8.703291e-01
##  [70,] 7.250768e-01 7.250768e-01
##  [71,] 8.183571e-01 8.183571e-01
##  [72,] 8.465036e-01 8.465036e-01
##  [73,] 8.786838e-01 8.786838e-01
##  [74,] 1.651543e-01 1.651543e-01
##  [75,] 3.951569e-01 3.951569e-01
##  [76,] 1.754280e-01 1.754280e-01
##  [77,] 3.649865e-01 3.649865e-01
##  [78,] 7.224226e-02 7.224226e-02
##  [79,] 6.565152e-01 6.565152e-01
##  [80,] 9.946559e-01 9.946559e-01
##  [81,] 3.715952e-01 3.715952e-01
##  [82,] 8.424336e-02 8.424336e-02
##  [83,] 4.549887e-01 4.549887e-01
##  [84,] 8.530113e-01 8.530113e-01
##  [85,] 1.970777e-01 1.970777e-01
##  [86,] 2.298117e-01 2.298117e-01
##  [87,] 1.148832e-01 1.148832e-01
##  [88,] 7.769502e-01 7.769502e-01
##  [89,] 4.934348e-01 4.934348e-01
##  [90,] 3.526049e-01 3.526049e-01
##  [91,] 2.036013e-01 2.036013e-01
##  [92,] 8.838914e-01 8.838914e-01
##  [93,] 6.474880e-02 6.474880e-02
##  [94,] 4.089082e-01 4.089082e-01
##  [95,] 5.780132e-01 5.780132e-01
##  [96,] 8.011408e-01 8.011408e-01
##  [97,] 5.956061e-01 5.956061e-01
##  [98,] 9.266689e-01 9.266689e-01
##  [99,] 9.923205e-02 9.923205e-02
## [100,] 1.763972e-01 1.763972e-01</code></pre>
</div>
<div id="exercise-7-from-page-214" class="section level2">
<h2>Exercise 7 from page 214</h2>
<ul>
<li>Implement mcsapply(), a multicore version of sapply().</li>
<li>Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb127-2" title="2">mcsapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, ..., <span class="dt">simplify =</span> <span class="ot">TRUE</span>, <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>, <span class="dt">chunk.size =</span> <span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb127-3" title="3">  <span class="co"># 计算可用线程数，并设置并行使用线程数</span></a>
<a class="sourceLine" id="cb127-4" title="4">  no_cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>() <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb127-5" title="5">  <span class="co"># 初始化</span></a>
<a class="sourceLine" id="cb127-6" title="6">  cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(no_cores)</a>
<a class="sourceLine" id="cb127-7" title="7">  ans &lt;-<span class="st"> </span><span class="kw">parSapply</span>(cl, X, FUN, ..., <span class="dt">simplify =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb127-8" title="8">            <span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>, <span class="dt">chunk.size =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb127-9" title="9">  <span class="kw">stopCluster</span>(cl)</a>
<a class="sourceLine" id="cb127-10" title="10">  <span class="kw">return</span>(ans)</a>
<a class="sourceLine" id="cb127-11" title="11">}</a>
<a class="sourceLine" id="cb127-12" title="12"></a>
<a class="sourceLine" id="cb127-13" title="13"></a>
<a class="sourceLine" id="cb127-14" title="14"><span class="co"># example</span></a>
<a class="sourceLine" id="cb127-15" title="15"><span class="kw">mcsapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</a></code></pre></div>
<pre><code>##   [1] 9.813226e-01 1.619096e-05 6.242135e-01 6.693526e-01 5.677105e-01
##   [6] 6.610740e-01 5.951636e-01 5.005347e-01 4.763110e-01 3.429965e-01
##  [11] 8.155394e-01 7.197238e-01 1.244336e-01 2.229164e-01 1.113099e-02
##  [16] 4.625765e-01 6.515865e-01 1.658793e-01 9.342672e-01 8.011934e-01
##  [21] 4.627657e-01 5.927934e-01 2.929669e-01 5.737967e-01 3.451537e-02
##  [26] 2.739138e-01 2.656151e-01 8.196695e-01 6.647355e-01 8.056529e-01
##  [31] 5.060850e-01 7.106543e-01 2.321066e-01 1.106223e-01 5.459279e-01
##  [36] 1.865470e-02 2.433776e-01 2.688851e-01 9.819256e-01 4.940184e-01
##  [41] 3.268275e-01 8.000439e-01 9.822499e-01 1.936454e-01 7.390101e-01
##  [46] 3.888930e-02 4.350424e-01 7.434339e-02 5.787441e-01 4.864951e-01
##  [51] 1.476288e-01 5.524909e-01 7.129280e-01 8.683479e-03 9.053256e-02
##  [56] 4.415463e-01 4.955063e-01 1.745328e-01 6.615399e-01 4.479199e-01
##  [61] 2.885849e-01 3.028567e-02 1.018907e-01 1.811861e-02 6.376441e-01
##  [66] 1.408742e-02 9.008128e-02 4.515933e-01 8.703291e-01 7.250768e-01
##  [71] 8.183571e-01 8.465036e-01 8.786838e-01 1.651543e-01 3.951569e-01
##  [76] 1.754280e-01 3.649865e-01 7.224226e-02 6.565152e-01 9.946559e-01
##  [81] 3.715952e-01 8.424336e-02 4.549887e-01 8.530113e-01 1.970777e-01
##  [86] 2.298117e-01 1.148832e-01 7.769502e-01 4.934348e-01 3.526049e-01
##  [91] 2.036013e-01 8.838914e-01 6.474880e-02 4.089082e-01 5.780132e-01
##  [96] 8.011408e-01 5.956061e-01 9.266689e-01 9.923205e-02 1.763972e-01</code></pre>
<blockquote>
<p>We can’t implement Mcvapply. The superficial reason is that we cannot find a parVapply similar to parSapply versus sapply. The essential reason I think is that the working mechanism of vapply is causing it to have no way to parallelize.</p>
</blockquote>
</div>
</div>
<div id="hw-2019-12-20" class="section level1">
<h1>HW 2019-12-20</h1>
<div id="exercise" class="section level2">
<h2>Exercise</h2>
<ul>
<li>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R).Rewrite an Rcpp function for the same task.</li>
<li>Compare the generated random numbers by the two functions using <strong>qqplot</strong>.</li>
<li>Campare the computation time of the two functions with <strong>microbenchmark</strong>.</li>
<li>Comments your results.</li>
</ul>
<blockquote>
<p>Exercise9.4: Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2).The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}, x\sim\mathbb{R}\)</span>.</p>
</blockquote>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">N &lt;-<span class="st"> </span><span class="dv">2000</span> </a>
<a class="sourceLine" id="cb129-2" title="2">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb129-3" title="3">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a></code></pre></div>
</div>
<div id="rcpp-function" class="section level2">
<h2>Rcpp function</h2>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb130-2" title="2"></a>
<a class="sourceLine" id="cb130-3" title="3"><span class="co">#dir_cpp &lt;- &#39;../Rcpp/&#39; # Can create source file in Rstudio </span></a>
<a class="sourceLine" id="cb130-4" title="4"><span class="co">#sourceCpp(&quot;rwme.cpp&quot;)</span></a></code></pre></div>
</div>
<div id="r-function" class="section level2">
<h2>R function</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">lap.f &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb131-2" title="2">  <span class="co"># prop density function of Laplace distribution</span></a>
<a class="sourceLine" id="cb131-3" title="3">  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb131-4" title="4">}</a>
<a class="sourceLine" id="cb131-5" title="5">randomwalk &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){ </a>
<a class="sourceLine" id="cb131-6" title="6">  <span class="co"># function to generate a random walk metropolis chain</span></a>
<a class="sourceLine" id="cb131-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>) </a>
<a class="sourceLine" id="cb131-8" title="8">  x[<span class="dv">1</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>x0 </a>
<a class="sourceLine" id="cb131-9" title="9">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N) </a>
<a class="sourceLine" id="cb131-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){ </a>
<a class="sourceLine" id="cb131-11" title="11">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma) </a>
<a class="sourceLine" id="cb131-12" title="12">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap.f</span>(y)<span class="op">/</span><span class="kw">lap.f</span>(x[i<span class="dv">-1</span>]))){</a>
<a class="sourceLine" id="cb131-13" title="13">      x[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb131-14" title="14">      x[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb131-15" title="15">    }<span class="cf">else</span>{ </a>
<a class="sourceLine" id="cb131-16" title="16">      x[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>] </a>
<a class="sourceLine" id="cb131-17" title="17">      x[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">0</span>} </a>
<a class="sourceLine" id="cb131-18" title="18">    } </a>
<a class="sourceLine" id="cb131-19" title="19">  <span class="kw">return</span>(x) </a>
<a class="sourceLine" id="cb131-20" title="20">} </a></code></pre></div>
</div>
<div id="genereate-random-numbers-by-the-two-functions" class="section level2">
<h2>Genereate random numbers by the two functions</h2>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1">rw1 &lt;-<span class="st"> </span><span class="kw">randomwalk</span>(sigma[<span class="dv">1</span>], x0, N) </a>
<a class="sourceLine" id="cb132-2" title="2">rw2 &lt;-<span class="st"> </span><span class="kw">randomwalk</span>(sigma[<span class="dv">2</span>], x0, N) </a>
<a class="sourceLine" id="cb132-3" title="3">rw3 &lt;-<span class="st"> </span><span class="kw">randomwalk</span>(sigma[<span class="dv">3</span>], x0, N) </a>
<a class="sourceLine" id="cb132-4" title="4">rw4 &lt;-<span class="st"> </span><span class="kw">randomwalk</span>(sigma[<span class="dv">4</span>], x0, N)</a></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="co">#rw5 &lt;- rwme(sigma[1], x0, N)</span></a>
<a class="sourceLine" id="cb133-2" title="2"><span class="co">#rw6 &lt;- rwme(sigma[2], x0, N) </span></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="co">#rw7 &lt;- rwme(sigma[3], x0, N) </span></a>
<a class="sourceLine" id="cb133-4" title="4"><span class="co">#rw8 &lt;- rwme(sigma[4], x0, N)</span></a></code></pre></div>
</div>
<div id="compare-the-generated-random-numbers" class="section level2">
<h2>Compare the generated random numbers</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1">acR &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(rw1[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>),<span class="kw">sum</span>(rw2[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>),<span class="kw">sum</span>(rw3[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>),<span class="kw">sum</span>(rw4[,<span class="dv">2</span>]<span class="op">==</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb134-2" title="2"><span class="co">#acC &lt;- c(sum(rw5[,2]==1),sum(rw6[,2]==1),sum(rw7[,2]==1),sum(rw8[,2]==1))</span></a>
<a class="sourceLine" id="cb134-3" title="3"><span class="kw">rbind</span>(sigma,acR)</a></code></pre></div>
<pre><code>##          [,1]   [,2] [,3] [,4]
## sigma    0.05    0.5    2   16
## acR   1972.00 1649.0 1066  213</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="co">####par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb136-2" title="2"><span class="co">#qqplot(rw1[rw1[,2]==1,1],rw5[rw5[,2]==1,1],xlab = &quot;rwR&quot;,ylab = &quot;rwC&quot;,main = expression(&quot;Q-Q plot for&quot; ~~ {sigma==0.05}))</span></a>
<a class="sourceLine" id="cb136-3" title="3"><span class="co">#qqplot(rw2[rw2[,2]==1,1],rw6[rw6[,2]==1,1],xlab = &quot;rwR&quot;,ylab = &quot;rwC&quot;,main = expression(&quot;Q-Q plot for&quot; ~~ {sigma==0.5}))</span></a>
<a class="sourceLine" id="cb136-4" title="4"><span class="co">#qqplot(rw3[rw3[,2]==1,1],rw7[rw7[,2]==1,1],xlab = &quot;rwR&quot;,ylab = &quot;rwC&quot;,main = expression(&quot;Q-Q plot for&quot; ~~ {sigma==2}))</span></a>
<a class="sourceLine" id="cb136-5" title="5"><span class="co">#qqplot(rw4[rw4[,2]==1,1],rw8[rw8[,2]==1,1],xlab = &quot;rwR&quot;,ylab = &quot;rwC&quot;,main = expression(&quot;Q-Q plot for&quot; ~~ {sigma==16}))</span></a></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">library</span>(microbenchmark) </a>
<a class="sourceLine" id="cb137-2" title="2"><span class="co">#ts &lt;- microbenchmark(rwR1 &lt;- randomwalk(sigma[1], x0, N) ,rwR2 &lt;- randomwalk(sigma[2], x0, N) ,rwR3 &lt;- randomwalk(sigma[3], x0, N) ,rwR4 &lt;- randomwalk(sigma[4], x0, N) ,rwC1 &lt;- rwme(sigma[1], x0, N) ,rwC2 &lt;- rwme(sigma[2], x0, N) ,rwC3 &lt;- rwme(sigma[3], x0, N)  ,rwC4 &lt;- rwme(sigma[4], x0, N))</span></a>
<a class="sourceLine" id="cb137-3" title="3"><span class="co">#summary(ts)[,c(1,3,5,6)] </span></a></code></pre></div>
</div>
<div id="comment-on-our-result" class="section level2">
<h2>Comment on our result</h2>
<ul>
<li><p>We found that when the variance sigma is large enough, the qq-plot of random Numbers obtained by Rcpp and R is relatively close to and proportional to, except the two ends.</p></li>
<li><p>However, the calculation time of Rcpp is significantly less than R, which also indicates that Rcpp can effectively improve our calculation efficiency.</p></li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
